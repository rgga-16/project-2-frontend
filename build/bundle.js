var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function i(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let c,r;function a(e,t){return c||(c=document.createElement("a")),c.href=t,e===c.href}function l(e,t){e.appendChild(t)}function d(e,t,n){e.insertBefore(t,n||null)}function u(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function g(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function m(){return f(" ")}function h(){return f("")}function v(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function b(e){return function(t){return t.preventDefault(),e.call(this,t)}}function w(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function k(e,t){t=""+t,e.data!==t&&(e.data=t)}function y(e,t){e.value=null==t?"":t}function _(e,t,n,o){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function x(e,t,n){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}n&&void 0===t||(e.selectedIndex=-1)}function $(e,t,n){e.classList[n?"add":"remove"](t)}function q(e){r=e}function F(e){(function(){if(!r)throw new Error("Function called outside component initialization");return r})().$$.on_mount.push(e)}const T=[],L=[];let S=[];const C=[],N=Promise.resolve();let O=!1;function j(e){S.push(e)}function A(e){C.push(e)}const M=new Set;let E=0;function H(){if(0!==E)return;const e=r;do{try{for(;E<T.length;){const e=T[E];E++,q(e),P(e.$$)}}catch(e){throw T.length=0,E=0,e}for(q(null),T.length=0,E=0;L.length;)L.pop()();for(let e=0;e<S.length;e+=1){const t=S[e];M.has(t)||(M.add(t),t())}S.length=0}while(T.length);for(;C.length;)C.pop()();O=!1,M.clear(),q(e)}function P(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(j)}}const D=new Set;let R;function U(){R={r:0,c:[],p:R}}function I(){R.r||o(R.c),R=R.p}function J(e,t){e&&e.i&&(D.delete(e),e.i(t))}function V(e,t,n,o){if(e&&e.o){if(D.has(e))return;D.add(e),R.c.push((()=>{D.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}else o&&o()}function B(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function W(e){e&&e.c()}function z(e,n,s,c){const{fragment:r,after_update:a}=e.$$;r&&r.m(n,s),c||j((()=>{const n=e.$$.on_mount.map(t).filter(i);e.$$.on_destroy?e.$$.on_destroy.push(...n):o(n),e.$$.on_mount=[]})),a.forEach(j)}function G(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];S.forEach((o=>-1===e.indexOf(o)?t.push(o):n.push(o))),n.forEach((e=>e())),S=t}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Y(e,t){-1===e.$$.dirty[0]&&(T.push(e),O||(O=!0,N.then(H)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Q(t,i,s,c,a,l,d,p=[-1]){const g=r;q(t);const f=t.$$={fragment:null,ctx:[],props:l,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(g?g.$$.context:[])),callbacks:n(),dirty:p,skip_bound:!1,root:i.target||g.$$.root};d&&d(f.root);let m=!1;if(f.ctx=s?s(t,i.props||{},((e,n,...o)=>{const i=o.length?o[0]:n;return f.ctx&&a(f.ctx[e],f.ctx[e]=i)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](i),m&&Y(t,e)),n})):[],f.update(),m=!0,o(f.before_update),f.fragment=!!c&&c(f.ctx),i.target){if(i.hydrate){const e=function(e){return Array.from(e.childNodes)}(i.target);f.fragment&&f.fragment.l(e),e.forEach(u)}else f.fragment&&f.fragment.c();i.intro&&J(t.$$.fragment),z(t,i.target,i.anchor,i.customElement),H()}q(g)}class K{$destroy(){G(this,1),this.$destroy=e}$on(t,n){if(!i(n))return e;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const e=o.indexOf(n);-1!==e&&o.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function X(t){let n,o,i,s,c,r,a,p,h;return{c(){n=g("div"),o=g("span"),i=f("["),s=f(t[0]),c=f("%] "),r=f(t[1]),a=m(),p=g("div"),h=g("div"),w(o,"class","status-text svelte-e99ivy"),w(h,"class","loading-bar-progress svelte-e99ivy"),_(h,"width",t[0]+"%"),w(p,"class","loading-bar-container svelte-e99ivy"),w(n,"class","container column centered spaced svelte-e99ivy")},m(e,t){d(e,n,t),l(n,o),l(o,i),l(o,s),l(o,c),l(o,r),l(n,a),l(n,p),l(p,h)},p(e,[t]){1&t&&k(s,e[0]),2&t&&k(r,e[1]),1&t&&_(h,"width",e[0]+"%")},i:e,o:e,d(e){e&&u(n)}}}function Z(e,t,n){let{progress:o=0}=t,{status:i=""}=t;return e.$$set=e=>{"progress"in e&&n(0,o=e.progress),"status"in e&&n(1,i=e.status)},[o,i]}class ee extends K{constructor(e){super(),Q(this,e,Z,X,s,{progress:0,status:1})}}async function te(e){return new Promise((t=>setTimeout(t,e)))}async function ne(e,t){const n=await fetch("/log_action",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,data:t})});if(!n.ok)throw new Error("Failed to log action");const o=await n.json();console.log(o.message)}function oe(e,t){t.currentTime=function(e){let t=e.split(":");return 3600*parseInt(t[0])+60*parseInt(t[1])+parseInt(t[2].split(",")[0])+parseInt(t[2].split(",")[1])/1e3}(e),t.play()}function ie(e){let t=parseInt(e.dialogue_id),n=document.getElementById(t);n?n.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}):console.log("Error: Can't focus on feedback. Corresponding transcript excerpt not found.")}function se(e,t,n){const o=e.slice();return o[55]=t[n][0],o[56]=t[n][1],o}function ce(e,t,n){const o=e.slice();return o[59]=t[n],o[61]=n,o}function re(t){let n;return{c(){n=g("span"),n.textContent="No feedback moments highlighted."},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function ae(e){let t,n,o,i,s,c=e[2]+1+"",r=e[1].length+"";return{c(){t=g("span"),n=f(c),o=f(" of "),i=f(r),s=f(" feedback moments highlighted")},m(e,c){d(e,t,c),l(t,n),l(t,o),l(t,i),l(t,s)},p(e,t){4&t[0]&&c!==(c=e[2]+1+"")&&k(n,c),2&t[0]&&r!==(r=e[1].length+"")&&k(i,r)},d(e){e&&u(t)}}}function le(t){let n;return{c(){n=g("div"),n.innerHTML="<span>No discussion transcript loaded. Please first record or upload your discussion.</span>",w(n,"class","centered"),_(n,"height","100%"),_(n,"width","100%")},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function de(e){let t,n=e[0].transcript_list,o=[];for(let t=0;t<n.length;t+=1)o[t]=ue(ce(e,n,t));return{c(){t=g("p");for(let e=0;e<o.length;e+=1)o[e].c();w(t,"class","padded")},m(e,n){d(e,t,n);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null)},p(e,i){if(9&i[0]){let s;for(n=e[0].transcript_list,s=0;s<n.length;s+=1){const c=ce(e,n,s);o[s]?o[s].p(c,i):(o[s]=ue(c),o[s].c(),o[s].m(t,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){e&&u(t),p(o,e)}}}function ue(e){let t,n,i,s,c,r,a,p,h,b,y,_,x,$,q,F,T,L,S,C,N,O,j,A=e[59].start_timestamp+"",M=e[59].end_timestamp+"",E=e[59].speaker?e[59].speaker+":":"",H=e[59].dialogue+"";function P(){return e[18](e[59])}function D(){return e[19](e[59])}return{c(){t=g("div"),n=g("span"),i=f("["),s=f(A),c=f("]"),r=f(" \n                            - \n                            "),a=g("span"),p=f("["),h=f(M),b=f("]"),y=m(),_=g("br"),x=m(),$=f(E),q=m(),F=g("span"),L=m(),S=g("br"),C=g("br"),N=m(),w(n,"class","timestamp svelte-ir33lb"),w(a,"class","timestamp svelte-ir33lb"),w(F,"id",T=e[59].id),w(F,"class","svelte-ir33lb"),w(t,"class","spaced")},m(e,o){d(e,t,o),l(t,n),l(n,i),l(n,s),l(n,c),l(t,r),l(t,a),l(a,p),l(a,h),l(a,b),l(t,y),l(t,_),l(t,x),l(t,$),l(t,q),l(t,F),F.innerHTML=H,l(t,L),l(t,S),l(t,C),l(t,N),O||(j=[v(n,"click",P),v(a,"click",D)],O=!0)},p(t,n){e=t,1&n[0]&&A!==(A=e[59].start_timestamp+"")&&k(s,A),1&n[0]&&M!==(M=e[59].end_timestamp+"")&&k(h,M),1&n[0]&&E!==(E=e[59].speaker?e[59].speaker+":":"")&&k($,E),1&n[0]&&H!==(H=e[59].dialogue+"")&&(F.innerHTML=H),1&n[0]&&T!==(T=e[59].id)&&w(F,"id",T)},d(e){e&&u(t),O=!1,o(j)}}}function pe(t){let n,o;return{c(){n=g("video"),n.innerHTML='<track kind="captions" src="blank.vtt" srclang="en"/>',a(n.src,o="video.mp4")||w(n,"src","video.mp4"),n.controls=!0,_(n,"width","100%"),_(n,"height","100%")},m(e,o){d(e,n,o),t[34](n)},p:e,d(e){e&&u(n),t[34](null)}}}function ge(e){let t,n;return{c(){t=g("audio"),a(t.src,n=e[0].audio)||w(t,"src",n),t.controls=!0,_(t,"width","100%"),_(t,"height","100%")},m(n,o){d(n,t,o),e[33](t)},p(e,o){1&o[0]&&!a(t.src,n=e[0].audio)&&w(t,"src",n)},d(n){n&&u(t),e[33](null)}}}function fe(e){let t,n,o,i;return{c(){t=g("video"),n=g("track"),w(n,"kind","captions"),a(n.src,o="blank.vtt")||w(n,"src","blank.vtt"),w(n,"srclang","en"),a(t.src,i=e[0].video)||w(t,"src",i),t.controls=!0,_(t,"width","100%"),_(t,"height","100%")},m(o,i){d(o,t,i),l(t,n),e[32](t)},p(e,n){1&n[0]&&!a(t.src,i=e[0].video)&&w(t,"src",i)},d(n){n&&u(t),e[32](null)}}}function me(e){let t,n,o="speaker"in e[0].transcript_list[0]&&he(e),i=e[1]&&be(e);return{c(){o&&o.c(),t=m(),i&&i.c(),n=h()},m(e,s){o&&o.m(e,s),d(e,t,s),i&&i.m(e,s),d(e,n,s)},p(e,s){"speaker"in e[0].transcript_list[0]?o?o.p(e,s):(o=he(e),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null),e[1]?i?i.p(e,s):(i=be(e),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(e){o&&o.d(e),e&&u(t),i&&i.d(e),e&&u(n)}}}function he(e){let t,n,o,i,s,c,r,a,h,v=Object.keys(e[0].transcript_list.reduce(Te,{})).length+"",b=Object.entries(e[0].transcript_list.reduce(Le,{})),w=[];for(let t=0;t<b.length;t+=1)w[t]=ve(se(e,b,t));return{c(){t=g("strong"),n=f("Number of participants: "),o=f(v),i=m(),s=g("br"),c=m(),r=g("ul");for(let e=0;e<w.length;e+=1)w[e].c();a=m(),h=g("br")},m(e,u){d(e,t,u),l(t,n),l(t,o),d(e,i,u),d(e,s,u),d(e,c,u),d(e,r,u);for(let e=0;e<w.length;e+=1)w[e]&&w[e].m(r,null);d(e,a,u),d(e,h,u)},p(e,t){if(1&t[0]&&v!==(v=Object.keys(e[0].transcript_list.reduce(Te,{})).length+"")&&k(o,v),1&t[0]){let n;for(b=Object.entries(e[0].transcript_list.reduce(Le,{})),n=0;n<b.length;n+=1){const o=se(e,b,n);w[n]?w[n].p(o,t):(w[n]=ve(o),w[n].c(),w[n].m(r,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=b.length}},d(e){e&&u(t),e&&u(i),e&&u(s),e&&u(c),e&&u(r),p(w,e),e&&u(a),e&&u(h)}}}function ve(e){let t,n,o,i,s,c,r,a=e[55]+"",p=e[56]+"";return{c(){t=g("li"),n=f("- "),o=f(a),i=f(": "),s=f(p),c=f(" utterances"),r=m()},m(e,a){d(e,t,a),l(t,n),l(t,o),l(t,i),l(t,s),l(t,c),d(e,r,a)},p(e,t){1&t[0]&&a!==(a=e[55]+"")&&k(o,a),1&t[0]&&p!==(p=e[56]+"")&&k(s,p)},d(e){e&&u(t),e&&u(r)}}}function be(e){let t,n,o,i,s,c,r,a,p,h,v,b,w=e[1].length+"",y=e[1].filter(Se).length+"",_=e[1].filter(Ce).length+"";return{c(){t=g("strong"),n=f("Number of feedback utterances: "),o=f(w),i=m(),s=g("ul"),c=g("li"),r=f("- Number of positive feedback: "),a=f(y),p=m(),h=g("li"),v=f("- Number of critical feedback: "),b=f(_)},m(e,u){d(e,t,u),l(t,n),l(t,o),d(e,i,u),d(e,s,u),l(s,c),l(c,r),l(c,a),l(s,p),l(s,h),l(h,v),l(h,b)},p(e,t){2&t[0]&&w!==(w=e[1].length+"")&&k(o,w),2&t[0]&&y!==(y=e[1].filter(Se).length+"")&&k(a,y),2&t[0]&&_!==(_=e[1].filter(Ce).length+"")&&k(b,_)},d(e){e&&u(t),e&&u(i),e&&u(s)}}}function we(e){let t,n,i,s,c,r,p,h,b,k,y,x,q,F,T,S,C,N,O,j,M,E,H,P,D,R,U,I,Y,Q,K,X,Z,te,ne,oe,ie,se,ce,ue,he,ve,be,we,ke,ye,_e,xe,$e,qe,Fe,Te,Le,Se,Ce,Ne,Oe,je,Ae,Me,Ee,He,Pe,De,Re,Ue,Ie,Je,Ve,Be,We,ze,Ge,Ye,Qe,Ke,Xe,Ze,et,tt,nt,ot,it,st,ct,rt,at,lt,dt,ut,pt,gt,ft,mt,ht,vt,bt;function wt(t){e[14](t)}function kt(t){e[15](t)}let yt={};function _t(e,t){return e[1]&&e[1].length>0?ae:re}void 0!==e[8]&&(yt.progress=e[8]),void 0!==e[7]&&(yt.status=e[7]),c=new ee({props:yt}),L.push((()=>B(c,"progress",wt))),L.push((()=>B(c,"status",kt)));let xt=_t(e),$t=xt(e);function qt(e,t){return e[0]&&e[0].transcript_list?de:le}let Ft=qt(e),Tt=Ft(e);function Lt(e,t){return e[0]&&e[0].video?fe:e[0]&&e[0].audio?ge:pe}let St=Lt(e),Ct=St(e),Nt=e[0]&&e[0].transcript_list&&me(e);return{c(){t=g("div"),n=g("div"),i=g("div"),s=g("div"),W(c.$$.fragment),h=m(),b=g("div"),$t.c(),k=m(),y=g("button"),x=g("img"),T=m(),S=g("button"),C=g("img"),j=m(),Tt.c(),M=m(),E=g("div"),H=g("div"),P=g("span"),P.textContent="Step 1: Upload your discussion.",D=m(),R=g("div"),U=g("div"),I=g("div"),Y=g("label"),Y.textContent="Upload your own video or audio:",Q=m(),K=g("div"),X=g("input"),Z=m(),te=g("button"),ne=g("img"),ie=f("\n                                    Upload file"),ce=m(),ue=g("div"),he=g("label"),he.textContent="Upload your own transcript (in .srt only):",ve=m(),be=g("div"),we=g("input"),ke=m(),ye=g("button"),_e=g("img"),$e=f("\n                                    Upload file"),Fe=m(),Te=g("div"),Le=g("span"),Le.textContent="Step 2: Highlight feedback in the discussion's transcript.",Se=m(),Ce=g("div"),Ne=g("div"),Oe=g("button"),je=g("img"),Me=f("\n                            Auto-detect "),Ee=g("br"),He=f(" Feedback"),De=m(),Re=g("button"),Ue=g("img"),Je=f("\n                            Highlight "),Ve=g("br"),Be=f(" Positive"),ze=m(),Ge=g("button"),Ye=g("img"),Ke=f("\n                            Highlight "),Xe=g("br"),Ze=f(" Critical"),tt=m(),nt=g("button"),ot=g("img"),st=f("\n                            Remove "),ct=g("br"),rt=f(" Feedback"),lt=m(),dt=g("div"),ut=g("div"),Ct.c(),pt=m(),gt=g("div"),ft=g("h3"),ft.textContent="Discussion Transcript Details",mt=m(),Nt&&Nt.c(),w(s,"class","overlay centered padded"),$(s,"invisible",!1===e[6]),a(x.src,q="./logos/up-arrow-5-svgrepo-com.svg")||w(x,"src","./logos/up-arrow-5-svgrepo-com.svg"),w(x,"alt","Prev feedback"),w(x,"class","logo"),_(x,"width","1.5rem"),_(x,"height","1.5rem"),y.disabled=F=!e[1]||e[1].length<=0,a(C.src,N="./logos/down-arrow-5-svgrepo-com.svg")||w(C,"src","./logos/down-arrow-5-svgrepo-com.svg"),w(C,"alt","Next feedback"),w(C,"class","logo"),_(C,"width","1.5rem"),_(C,"height","1.5rem"),S.disabled=O=!e[1]||e[1].length<=0,w(b,"id","traverse-feedback-area"),w(b,"class","bordered spaced svelte-ir33lb"),w(i,"id","transcript-area"),w(i,"class","column bordered spaced svelte-ir33lb"),_(P,"font-weight","bold"),_(P,"text-decoration","underline"),_(P,"margin-left","1rem"),w(Y,"for","file_upload"),_(X,"width","50%"),w(X,"name","file_upload"),w(X,"type","file"),w(X,"id","file_upload"),w(X,"accept","video/*, audio/*"),a(ne.src,oe="./logos/upload-svgrepo-com.svg")||w(ne,"src","./logos/upload-svgrepo-com.svg"),w(ne,"alt","Upload file"),w(ne,"class","mini-icon"),w(te,"class","action-button centered column  svelte-ir33lb"),te.disabled=se=e[6]||!e[4]||0===e[4].length,w(K,"class","row centered spaced"),w(I,"class","column spaced centered"),w(he,"for","file_upload"),w(we,"name","file_upload"),w(we,"type","file"),w(we,"id","file_upload"),w(we,"accept"," .srt"),a(_e.src,xe="./logos/upload-svgrepo-com.svg")||w(_e,"src","./logos/upload-svgrepo-com.svg"),w(_e,"alt","Upload file"),w(_e,"class","mini-icon"),w(ye,"class","action-button centered column  svelte-ir33lb"),ye.disabled=qe=e[6]||!e[4]||0===e[4].length,w(be,"class","row centered"),w(ue,"class","column spaced centered"),w(U,"class","row centered spaced"),w(R,"class","row centered spaced"),w(H,"id","capture-feedback-panel"),w(H,"class","column bordered padded centered spaced svelte-ir33lb"),_(Le,"font-weight","bold"),_(Le,"text-decoration","underline"),_(Le,"margin-left","1rem"),a(je.src,Ae="./logos/magnifying-glass-for-search-3-svgrepo-com.svg")||w(je,"src","./logos/magnifying-glass-for-search-3-svgrepo-com.svg"),w(je,"alt","Auto-detect Feedback"),w(je,"class","logo"),w(Oe,"class","action-button svelte-ir33lb"),Oe.disabled=Pe=!e[0]||!e[0].transcript_list||e[6],a(Ue.src,Ie="./logos/highlight-green-svgrepo-com.svg")||w(Ue,"src","./logos/highlight-green-svgrepo-com.svg"),w(Ue,"alt","Highlight Positive Feedback"),w(Ue,"class","logo"),w(Re,"class","action-button svelte-ir33lb"),Re.disabled=We=!e[0]||!e[0].transcript_list||e[6],a(Ye.src,Qe="./logos/highlight-red-svgrepo-com.svg")||w(Ye,"src","./logos/highlight-red-svgrepo-com.svg"),w(Ye,"alt","Highlight Critical Feedback"),w(Ye,"class","logo"),w(Ge,"class","action-button svelte-ir33lb"),Ge.disabled=et=!e[0]||!e[0].transcript_list||e[6],a(ot.src,it="./logos/erase-svgrepo-com.svg")||w(ot,"src","./logos/erase-svgrepo-com.svg"),w(ot,"alt","De-highlight Feedback"),w(ot,"class","logo"),w(nt,"class","action-button svelte-ir33lb"),nt.disabled=at=!e[0]||!e[0].transcript_list||e[6],w(Ne,"class","row centered spaced"),w(Ce,"class","centered"),_(Ce,"height","100%"),_(Ce,"width","100%"),w(Te,"id","feedback-highlight-panel"),w(Te,"class","column bordered spaced padded  svelte-ir33lb"),w(E,"id","transcript-buttons-area"),w(E,"class","row centered spaced svelte-ir33lb"),w(n,"id","left-panel"),w(n,"class","column spaced svelte-ir33lb"),w(ut,"id","media-player-area"),w(ut,"class","bordered centered svelte-ir33lb"),_(ft,"font-weight","bold"),_(ft,"text-decoration","underline"),w(gt,"id","feedback-details-area"),w(gt,"class","bordered padded spaced svelte-ir33lb"),_(gt,"overflow-y","auto"),w(dt,"id","right-panel"),w(dt,"class","column spaced svelte-ir33lb"),w(t,"div",""),w(t,"class","row spaced svelte-ir33lb"),w(t,"id","feedback-selector-page")},m(o,r){d(o,t,r),l(t,n),l(n,i),l(i,s),z(c,s,null),l(i,h),l(i,b),$t.m(b,null),l(b,k),l(b,y),l(y,x),l(b,T),l(b,S),l(S,C),l(i,j),Tt.m(i,null),l(n,M),l(n,E),l(E,H),l(H,P),l(H,D),l(H,R),l(R,U),l(U,I),l(I,Y),l(I,Q),l(I,K),l(K,X),e[21](X),l(K,Z),l(K,te),l(te,ne),l(te,ie),l(U,ce),l(U,ue),l(ue,he),l(ue,ve),l(ue,be),l(be,we),e[25](we),l(be,ke),l(be,ye),l(ye,_e),l(ye,$e),l(E,Fe),l(E,Te),l(Te,Le),l(Te,Se),l(Te,Ce),l(Ce,Ne),l(Ne,Oe),l(Oe,je),l(Oe,Me),l(Oe,Ee),l(Oe,He),l(Ne,De),l(Ne,Re),l(Re,Ue),l(Re,Je),l(Re,Ve),l(Re,Be),l(Ne,ze),l(Ne,Ge),l(Ge,Ye),l(Ge,Ke),l(Ge,Xe),l(Ge,Ze),l(Ne,tt),l(Ne,nt),l(nt,ot),l(nt,st),l(nt,ct),l(nt,rt),l(t,lt),l(t,dt),l(dt,ut),Ct.m(ut,null),l(dt,pt),l(dt,gt),l(gt,ft),l(gt,mt),Nt&&Nt.m(gt,null),ht=!0,vt||(bt=[v(y,"click",e[16]),v(S,"click",e[17]),v(X,"change",e[20]),v(X,"change",e[22]),v(te,"click",e[23]),v(we,"change",e[24]),v(we,"change",e[26]),v(ye,"click",e[27]),v(Oe,"click",e[28]),v(Re,"click",e[29]),v(Ge,"click",e[30]),v(nt,"click",e[31])],vt=!0)},p(e,t){const n={};!r&&256&t[0]&&(r=!0,n.progress=e[8],A((()=>r=!1))),!p&&128&t[0]&&(p=!0,n.status=e[7],A((()=>p=!1))),c.$set(n),(!ht||64&t[0])&&$(s,"invisible",!1===e[6]),xt===(xt=_t(e))&&$t?$t.p(e,t):($t.d(1),$t=xt(e),$t&&($t.c(),$t.m(b,k))),(!ht||2&t[0]&&F!==(F=!e[1]||e[1].length<=0))&&(y.disabled=F),(!ht||2&t[0]&&O!==(O=!e[1]||e[1].length<=0))&&(S.disabled=O),Ft===(Ft=qt(e))&&Tt?Tt.p(e,t):(Tt.d(1),Tt=Ft(e),Tt&&(Tt.c(),Tt.m(i,null))),(!ht||80&t[0]&&se!==(se=e[6]||!e[4]||0===e[4].length))&&(te.disabled=se),(!ht||80&t[0]&&qe!==(qe=e[6]||!e[4]||0===e[4].length))&&(ye.disabled=qe),(!ht||65&t[0]&&Pe!==(Pe=!e[0]||!e[0].transcript_list||e[6]))&&(Oe.disabled=Pe),(!ht||65&t[0]&&We!==(We=!e[0]||!e[0].transcript_list||e[6]))&&(Re.disabled=We),(!ht||65&t[0]&&et!==(et=!e[0]||!e[0].transcript_list||e[6]))&&(Ge.disabled=et),(!ht||65&t[0]&&at!==(at=!e[0]||!e[0].transcript_list||e[6]))&&(nt.disabled=at),St===(St=Lt(e))&&Ct?Ct.p(e,t):(Ct.d(1),Ct=St(e),Ct&&(Ct.c(),Ct.m(ut,null))),e[0]&&e[0].transcript_list?Nt?Nt.p(e,t):(Nt=me(e),Nt.c(),Nt.m(gt,null)):Nt&&(Nt.d(1),Nt=null)},i(e){ht||(J(c.$$.fragment,e),ht=!0)},o(e){V(c.$$.fragment,e),ht=!1},d(n){n&&u(t),G(c),$t.d(),Tt.d(),e[21](null),e[25](null),Ct.d(),Nt&&Nt.d(),vt=!1,o(bt)}}}async function ke(e){try{const t=await fetch("/fetch_audio",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audio_path:e})}),n=await t.blob();return URL.createObjectURL(n)}catch(e){console.error(e)}}async function ye(e){if(!(await fetch("/embed_transcript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:e})})).ok)throw new Error("Failed to embed transcript list")}async function _e(e){const t=new FormData;t.append("file",e);const n=await fetch("/extract_audio_from_video",{method:"POST",body:t});if(!n.ok)return null;const o=await n.json();return[o.audiopath,o.videopath]}async function xe(e){const t=await fetch("/simplify_transcript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:e})});if(!t.ok)throw new Error("Failed to simplify transcript string");return(await t.json()).simplified_transcript}async function $e(e){const t=await fetch("/transcript_to_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:e})});if(!t.ok)throw new Error("Failed to convert transcript string to list of excerpts");return(await t.json()).transcript_list}async function qe(e){let t=[],n=function(e){let t="";for(let n=0;n<e.length;n++){let o=e[n],i=o.id,s=o.start_timestamp,c=o.end_timestamp,r=o.dialogue;"speaker"in o&&""!=o.speaker?t+=`${i}\n${s} --\x3e ${c}\n${o.speaker}: ${r}\n\n`:t+=`${i}\n${s} --\x3e ${c}\n${r}\n\n`}return t}(e);const o=await fetch("/autodetect_feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:n})});if(!o.ok)throw new Error("Failed to detect feedback");return t=(await o.json()).feedback_list,console.log(t),t}function Fe(e,t){t=parseInt(t);for(let n=0;n<e.length;n++){let o=e[n];if(o.id===t)return o}return console.log("Error: Can't find excerpt with id",t),null}const Te=(e,t)=>(e[t.speaker]=!0,e),Le=(e,t)=>(e[t.speaker]=(e[t.speaker]||0)+1,e),Se=e=>"positive"===e.type,Ce=e=>"critical"===e.type;function Ne(e,t,n){let o,i,s,c,r,{recording:a}=t,{feedback_list:l}=t,d=0,u=!1,p="",g=0;async function f(){if(c){for(const e of c)if(console.log(e.type),e.type.includes("video")){if((a||"video"in a||"audio"in a||"transcript_list"in a||l.length>0)&&(a.video||a.audio||a.transcript_list)){if(!window.confirm("Uploading a new video will overwrite this recording and clear highlighted feedback. Do you want to proceed?"))return}n(1,l=[]);let t=URL.createObjectURL(e);if(n(7,p="Uploading video..."),n(8,g=50),[s,i]=await _e(e),!s)throw s=null,i=null,new Error("Failed to extract audio from video");let o=await ke(s),c=null,r=null;n(7,p="Done!"),n(8,g=100),te(1500),n(8,g=0),n(0,a={video:t,audio:o,transcript:c,transcript_list:r}),s=null,i=null}else if(e.type.includes("audio")){if((a||"audio"in a||"video"in a||"transcript_list"in a||l.length>0)&&(a.audio||a.video||a.transcript_list)){if(!window.confirm("Uploading a new audio will overwrite this recording and clear highlighted feedback. Do you want to proceed?"))return}n(1,l=[]);let t=URL.createObjectURL(e);n(7,p="Uploading audio..."),n(8,g=50);const o=new FormData;o.append("audio",e);const c=await fetch("/download_mic",{method:"POST",body:o});if(!c.ok)throw s=null,i=null,new Error("Failed to save uploaded audio");let r=await c.json();s=r.filepath;let d=null,u=null;n(7,p="Done!"),n(8,g=100),await te(1500),n(8,g=0),n(0,a={video:null,audio:t,transcript:d,transcript_list:u}),s=null,i=null}n(4,c=null),n(5,r.value="",r)}console.log("Recording",a),n(8,g=0),n(7,p="")}async function m(){if(c){for(const e of c)if(console.log(e.type),e.name.endsWith(".srt")){if((a||"transcript"in a||"transcript_list"in a||l.length>0)&&(a.transcript||a.transcript_list)){if(!window.confirm("Uploading a new transcript will overwrite the current transcript and clear highlighted feedback. Do you want to proceed?"))return}n(1,l=[]);let t=new FileReader;t.onload=async function(e){console.log(undefined),n(6,u=!0);let t=e.target.result;console.log(t),n(7,p="Cleaning transcript..."),n(8,g=30);let o=await xe(t);await te(1500);let i=await $e(o);console.log(i),n(7,p="Saving transcript as a database (this may take a while) ... "),n(8,g=60),await ye(i),console.log("Transcript list embedded"),n(7,p="Done!"),n(8,g=100),await te(500),n(8,g=0);let s={video:null,audio:null,transcript:o,transcript_list:i};a&&("video"in a&&a.video||"audio"in a&&a.audio)?(n(0,a.transcript_list=i,a),n(0,a.transcript=o,a),n(0,a)):n(0,a=s),n(6,u=!1)},t.readAsText(e)}n(4,c=null),n(5,r.value="",r)}console.log("Recording",a),n(8,g=0),n(7,p="")}function h(e){const t=window.getSelection().toString();if(""===t.trim())return alert("Please highlight text in the transcript with your mouse to add as feedback."),"Error: No text highlighted";if(t){let o={quote:t,type:e,done:!1,speaker:null,dialogue_id:null},i=function(e,t){console.log(t);for(let n=0;n<e.length;n++){let o=e[n],i=o.dialogue;if(o.speaker&&(i=o.speaker+": "+i),i.includes(t))return o}return null}(a.transcript_list,t);return i?(o.id=l.length+1,o.dialogue_id=i.id,o.speaker=i.speaker,o.excerpt_reference=i,o.chatbot_messages=[{role:"system",content:"You are an expert senior interior designer who is tasked to assist less experienced interior designers like students and junior interior designers with their work by answering their questions on a wide range of interior design topics. "}],l.push(o),n(1,l),n(0,a),w([o]),o):(console.log("Error: Corresponding transcript excerpt not found"),alert("Error: Corresponding transcript excerpt not found. Feedback not added."),"Error: Corresponding transcript excerpt not found for selection: "+t)}return alert("Please highlight text in the transcript with your mouse to add as feedback."),"Error: No text highlighted"}function v(){const e=window.getSelection().toString();if(""===e.trim())return alert("Please highlight the feedback you want to remove using your mouse."),"Error: No text highlighted";if(e)for(let t=0;t<l.length;t++){let o=l[t];if(o.quote.includes(e)){let e=parseInt(o.dialogue_id),i=o.quote;return l.splice(t,1),n(1,l),b(e,i),o}}return"Error: Feedback not found for selection: "+e}function b(e,t){for(let o=0;o<a.transcript_list.length;o++){let i=a.transcript_list[o];if(i.id===e){let e=i.dialogue,o=e.indexOf("<mark"),s=e.indexOf("</mark>")+7,c=e.slice(0,o)+t+e.slice(s);i.dialogue=c,i.dialogue=i.dialogue,n(0,a);break}}}function w(e){for(let t=0;t<e.length;t++){let n=e[t],o=n.type;if("positive"!=n.type&&"critical"!=n.type)continue;let i,s=parseInt(n.dialogue_id);for(let e=0;e<a.transcript_list.length;e++){let t=a.transcript_list[e];if(t.id===s){i=t;break}}if(!i){console.log("Error: Corresponding transcript excerpt not found");continue}let c=i.dialogue,r=c.indexOf(n.quote),l=r+n.quote.length,d=c.slice(0,r)+`<mark class="${o}" style="background-color:${"positive"===o?"lightgreen":"lightcoral"};">${n.quote}</mark>`+c.slice(l);i.dialogue=d}n(0,a)}F((async()=>{}));return e.$$set=e=>{"recording"in e&&n(0,a=e.recording),"feedback_list"in e&&n(1,l=e.feedback_list)},[a,l,d,o,c,r,u,p,g,f,m,h,v,w,function(e){g=e,n(8,g)},function(e){p=e,n(7,p)},async()=>{d>0?n(2,d--,d):n(2,d=l.length-1),ie(l[d]),await ne("FeedbackSelector: Traverse to previous feedback",l[d])},async()=>{d<l.length-1?n(2,d++,d):n(2,d=0),ie(l[d]),await ne("FeedbackSelector: Traverse to next feedback",l[d])},async e=>{oe(e.start_timestamp,o),await ne("FeedbackSelector: Seeked to start timestamp",e.start_timestamp)},async e=>{oe(e.end_timestamp,o),await ne("FeedbackSelector: Seeked to end timestamp",e.end_timestamp)},function(){c=this.files,n(4,c)},function(e){L[e?"unshift":"push"]((()=>{r=e,n(5,r)}))},async e=>{n(4,c=e.target.files),await ne("FeedbackSelector: Select media file",c)},async()=>{n(6,u=!0),await f(),n(6,u=!1),await ne("FeedbackSelector: Upload media",a)},function(){c=this.files,n(4,c)},function(e){L[e?"unshift":"push"]((()=>{r=e,n(5,r)}))},async e=>{n(4,c=e.target.files),await ne("FeedbackSelector: Select transcript file",c)},async()=>{n(6,u=!0),await m(),n(6,u=!1),await ne("FeedbackSelector: Upload transcript",a)},async()=>{if(l.length>0){if(!window.confirm("Auto-detecting again will clear all feedback highlighted. Do you want to proceed?"))return}n(6,u=!0),n(8,g=0);let e=a.transcript_list,t=Math.ceil(e.length/4),o=[e.slice(0,t),e.slice(t,2*t),e.slice(2*t,3*t),e.slice(3*t,e.length)];n(7,p="Detecting feedback in transcript ...");for(let e=0;e<o.length;e++){let t=await qe(o[e]);n(1,l=l.concat(t)),n(8,g=20*(e+1)),await te(250)}n(1,l),console.log(l);for(let e=0;e<l.length;e++){n(1,l[e].id=e+1,l);let t=l[e].dialogue_id,o=Fe(a.transcript_list,t);n(1,l[e].excerpt_reference=o,l)}n(1,l),n(7,p="Highlighting feedback ..."),w(l),await te(500),n(8,g=100),console.log("Feedback: "+l[0]),n(6,u=!1),n(8,g=0),n(7,p=""),await ne("FeedbackSelector: Auto-detect feedback",l)},async()=>{let e=h("positive");await ne("FeedbackSelector: Add positive feedback",e)},async()=>{let e=h("critical");await ne("FeedbackSelector: Add critical feedback",e)},async()=>{let e=v();await ne("FeedbackSelector: Remove feedback",e)},function(e){L[e?"unshift":"push"]((()=>{o=e,n(3,o)}))},function(e){L[e?"unshift":"push"]((()=>{o=e,n(3,o)}))},function(e){L[e?"unshift":"push"]((()=>{o=e,n(3,o)}))}]}class Oe extends K{constructor(e){super(),Q(this,e,Ne,we,s,{recording:0,feedback_list:1},null,[-1,-1])}}function je(t){let n,i,s,c,r,a,p;return{c(){n=g("div"),i=g("input"),s=m(),c=g("span"),r=f(t[0]),w(i,"type","range"),w(i,"min",t[1]),w(i,"max",t[2]),w(i,"step",t[3]),w(i,"id","rangeSlider"),w(i,"class","svelte-ohnqtn"),w(c,"id","sliderValue"),w(n,"class","centered spaced"),_(n,"width","100%"),_(n,"height","100%")},m(e,o){d(e,n,o),l(n,i),y(i,t[0]),l(n,s),l(n,c),l(c,r),a||(p=[v(i,"change",t[4]),v(i,"input",t[4])],a=!0)},p(e,[t]){2&t&&w(i,"min",e[1]),4&t&&w(i,"max",e[2]),8&t&&w(i,"step",e[3]),1&t&&y(i,e[0]),1&t&&k(r,e[0])},i:e,o:e,d(e){e&&u(n),a=!1,o(p)}}}function Ae(e,t,n){let{min:o=0}=t,{max:i=2}=t,{step:s=.1}=t,{value:c=1}=t;return e.$$set=e=>{"min"in e&&n(1,o=e.min),"max"in e&&n(2,i=e.max),"step"in e&&n(3,s=e.step),"value"in e&&n(0,c=e.value)},[c,o,i,s,function(){c=function(e){return""===e?null:+e}(this.value),n(0,c)}]}class Me extends K{constructor(e){super(),Q(this,e,Ae,je,s,{min:1,max:2,step:3,value:0})}}function Ee(e,t,n){const o=e.slice();return o[120]=t[n],o}function He(e,t,n){const o=e.slice();return o[123]=t[n],o[111]=n,o}function Pe(e,t,n){const o=e.slice();return o[123]=t[n],o[111]=n,o}function De(e,t,n){const o=e.slice();return o[115]=t[n],o[111]=n,o}function Re(e,t,n){const o=e.slice();return o[117]=t[n],o}function Ue(e,t,n){const o=e.slice();return o[112]=t[n],o}function Ie(e,t,n){const o=e.slice();return o[109]=t[n],o[111]=n,o}function Je(e,t,n){const o=e.slice();return o[126]=t[n],o[111]=n,o}function Ve(e,t,n){const o=e.slice();return o[128]=t[n],o[111]=n,o}function Be(e,t,n){const o=e.slice();return o[128]=t[n],o[129]=t,o[111]=n,o}function We(e,t,n){const o=e.slice();return o[126]=t[n],o[111]=n,o}function ze(e){let t,n,o,i,s=e[126]+"";function c(){return e[46](e[111])}return{c(){t=g("button"),n=f(s),w(t,"class","tab svelte-o0vqi5"),$(t,"active",e[111]===e[13]),$(t,"right-bordered",e[111]<e[32].length-1)},m(e,s){d(e,t,s),l(t,n),o||(i=v(t,"click",c),o=!0)},p(n,o){e=n,8192&o[0]&&$(t,"active",e[111]===e[13])},d(e){e&&u(t),o=!1,i()}}}function Ge(e){let t,n=e[0],o=[];for(let t=0;t<n.length;t+=1)o[t]=tt(Ve(e,n,t));return{c(){t=g("div");for(let e=0;e<o.length;e+=1)o[e].c();w(t,"class","grid svelte-o0vqi5"),_(t,"overflow-y","auto")},m(e,n){d(e,t,n);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null)},p(e,i){if(6657&i[0]|16&i[1]){let s;for(n=e[0],s=0;s<n.length;s+=1){const c=Ve(e,n,s);o[s]?o[s].p(c,i):(o[s]=tt(c),o[s].c(),o[s].m(t,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){e&&u(t),p(o,e)}}}function Ye(e){let t,n,i,s,c,r,f,h,b,k,y,x,$,q,F,T,L,S,C,N,O,j,A,M,E,H;function P(e,t){return e[28]&&"quote"===e[27]?ot:nt}let D=P(e),R=D(e);function U(e,t){return e[28]&&"speaker"===e[27]?st:it}let I=U(e),J=I(e),V=e[0],B=[];for(let t=0;t<V.length;t+=1)B[t]=ft(Be(e,V,t));return{c(){t=g("div"),n=g("div"),i=g("span"),i.innerHTML="<strong>ID</strong>",s=m(),c=g("span"),r=g("strong"),r.textContent="Feedback",f=m(),h=g("button"),R.c(),b=m(),k=g("span"),y=g("strong"),y.textContent="Speaker",x=m(),$=g("button"),J.c(),q=m(),F=g("span"),F.innerHTML="<strong>Actions</strong>",T=m(),L=g("span"),S=g("strong"),S.textContent="Done?",C=m(),N=g("button"),O=g("img"),M=m();for(let e=0;e<B.length;e+=1)B[e].c();w(i,"class","centered id-col svelte-o0vqi5"),w(h,"class","action-button"),w(c,"class","centered row spaced feedback-col svelte-o0vqi5"),w($,"class","action-button"),w(k,"class","centered row spaced speaker-col svelte-o0vqi5"),w(F,"id","feedback-buttons"),w(F,"class","centered row actions-col svelte-o0vqi5"),_(O,"height","1rem"),_(O,"width","1rem"),a(O.src,j=e[28]&&"done"===e[27]?"./logos/ascending-sort-svgrepo-com.svg":"./logos/descending-sort-svgrepo-com.svg")||w(O,"src",j),w(O,"alt",A=e[28]&&"done"===e[27]?"Sort ascending":"Sort descending"),w(O,"class","mini-icon"),w(N,"class","action-button"),w(L,"class","centered row spaced done-col svelte-o0vqi5"),w(n,"class","feedback-header row svelte-o0vqi5"),w(t,"class","column"),_(t,"overflow-y","auto")},m(o,a){d(o,t,a),l(t,n),l(n,i),l(n,s),l(n,c),l(c,r),l(c,f),l(c,h),R.m(h,null),l(n,b),l(n,k),l(k,y),l(k,x),l(k,$),J.m($,null),l(n,q),l(n,F),l(n,T),l(n,L),l(L,S),l(L,C),l(L,N),l(N,O),l(t,M);for(let e=0;e<B.length;e+=1)B[e]&&B[e].m(t,null);E||(H=[v(h,"click",e[47]),v($,"click",e[48]),v(N,"click",e[49])],E=!0)},p(e,n){if(D!==(D=P(e))&&(R.d(1),R=D(e),R&&(R.c(),R.m(h,null))),I!==(I=U(e))&&(J.d(1),J=I(e),J&&(J.c(),J.m($,null))),402653184&n[0]&&!a(O.src,j=e[28]&&"done"===e[27]?"./logos/ascending-sort-svgrepo-com.svg":"./logos/descending-sort-svgrepo-com.svg")&&w(O,"src",j),402653184&n[0]&&A!==(A=e[28]&&"done"===e[27]?"Sort ascending":"Sort descending")&&w(O,"alt",A),39441&n[0]|280&n[1]){let o;for(V=e[0],o=0;o<V.length;o+=1){const i=Be(e,V,o);B[o]?B[o].p(i,n):(B[o]=ft(i),B[o].c(),B[o].m(t,null))}for(;o<B.length;o+=1)B[o].d(1);B.length=V.length}},d(e){e&&u(t),R.d(),J.d(),p(B,e),E=!1,o(H)}}}function Qe(e){let t,n,i,s,c,r,a,p,h,b,y,_,x,q,F,T,L,S,C=e[128].quote+"",N=e[128].speaker+"";function O(e,t){return"excerpt_reference"in e[128]?Xe:Ke}let j=O(e),A=j(e);function M(){return e[59](e[128])}function E(...t){return e[60](e[128],...t)}return{c(){t=g("div"),n=g("span"),A.c(),i=m(),s=g("br"),c=m(),r=g("p"),a=f('"'),p=f(C),h=f('"'),b=m(),y=g("br"),_=m(),x=g("span"),q=f("- "),F=f(N),T=m(),w(n,"class","timestamp svelte-o0vqi5"),w(t,"class","positive-feedback-note svelte-o0vqi5"),$(t,"selected",e[128]===e[11])},m(e,o){d(e,t,o),l(t,n),A.m(n,null),l(t,i),l(t,s),l(t,c),l(t,r),l(r,a),l(r,p),l(r,h),l(t,b),l(t,y),l(t,_),l(t,x),l(x,q),l(x,F),l(t,T),L||(S=[v(n,"click",M),v(t,"click",E)],L=!0)},p(o,i){j===(j=O(e=o))&&A?A.p(e,i):(A.d(1),A=j(e),A&&(A.c(),A.m(n,null))),1&i[0]&&C!==(C=e[128].quote+"")&&k(p,C),1&i[0]&&N!==(N=e[128].speaker+"")&&k(F,N),2049&i[0]&&$(t,"selected",e[128]===e[11])},d(e){e&&u(t),A.d(),L=!1,o(S)}}}function Ke(t){let n;return{c(){n=f("[00:00:00]")},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function Xe(e){let t;function n(e,t){return"start_timestamp"in e[128].excerpt_reference?et:Ze}let o=n(e),i=o(e);return{c(){i.c(),t=h()},m(e,n){i.m(e,n),d(e,t,n)},p(e,s){o===(o=n(e))&&i?i.p(e,s):(i.d(1),i=o(e),i&&(i.c(),i.m(t.parentNode,t)))},d(e){i.d(e),e&&u(t)}}}function Ze(t){let n;return{c(){n=f("[00:00:00]")},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function et(e){let t,n,o,i=e[128].excerpt_reference.start_timestamp+"";return{c(){t=f("["),n=f(i),o=f("]")},m(e,i){d(e,t,i),d(e,n,i),d(e,o,i)},p(e,t){1&t[0]&&i!==(i=e[128].excerpt_reference.start_timestamp+"")&&k(n,i)},d(e){e&&u(t),e&&u(n),e&&u(o)}}}function tt(e){let t,n="positive"===e[128].type&&Qe(e);return{c(){n&&n.c(),t=h()},m(e,o){n&&n.m(e,o),d(e,t,o)},p(e,o){"positive"===e[128].type?n?n.p(e,o):(n=Qe(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&u(t)}}}function nt(e){let t,n;return{c(){t=g("img"),_(t,"height","1rem"),_(t,"width","1rem"),a(t.src,n="./logos/descending-sort-svgrepo-com.svg")||w(t,"src","./logos/descending-sort-svgrepo-com.svg"),w(t,"alt","Sort descending"),w(t,"class","mini-icon")},m(e,n){d(e,t,n)},d(e){e&&u(t)}}}function ot(e){let t,n;return{c(){t=g("img"),_(t,"height","1rem"),_(t,"width","1rem"),a(t.src,n="./logos/ascending-sort-svgrepo-com.svg")||w(t,"src","./logos/ascending-sort-svgrepo-com.svg"),w(t,"alt","Sort ascending"),w(t,"class","mini-icon")},m(e,n){d(e,t,n)},d(e){e&&u(t)}}}function it(e){let t,n;return{c(){t=g("img"),_(t,"height","1rem"),_(t,"width","1rem"),a(t.src,n="./logos/descending-sort-svgrepo-com.svg")||w(t,"src","./logos/descending-sort-svgrepo-com.svg"),w(t,"alt","Sort descending"),w(t,"class","mini-icon")},m(e,n){d(e,t,n)},d(e){e&&u(t)}}}function st(e){let t,n;return{c(){t=g("img"),_(t,"height","1rem"),_(t,"width","1rem"),a(t.src,n="./logos/ascending-sort-svgrepo-com.svg")||w(t,"src","./logos/ascending-sort-svgrepo-com.svg"),w(t,"alt","Sort ascending"),w(t,"class","mini-icon")},m(e,n){d(e,t,n)},d(e){e&&u(t)}}}function ct(e){let t,n,i,s,c,r,a,p,h,b,y,_,x,q,F,T,L,S,C,N,O,j,A,M,E,H,P,D=e[128].id+"",R=(e[128].speaker?e[128].speaker:"Unknown")+"";function U(e,t){return"excerpt_reference"in e[128]?at:rt}let I=U(e),J=I(e);function V(){return e[50](e[128])}function B(e,t){return e[128].positivised_quote&&e[128].show_paraphrased?pt:ut}let W=B(e),z=W(e);function G(){return e[53](e[128],e[129],e[111])}function Y(){return e[54](e[128])}function Q(){return e[55](e[128])}function K(){return e[56](e[128])}function X(){e[57].call(M,e[129],e[111])}function Z(...t){return e[58](e[128],...t)}return{c(){t=g("div"),n=g("span"),i=g("strong"),s=f(D),c=m(),r=g("div"),a=g("span"),p=g("span"),J.c(),h=m(),z.c(),b=m(),y=g("span"),_=f(R),x=m(),q=g("div"),F=g("button"),F.innerHTML='<img src="./logos/ai-positive-paraphrase.png" alt="Paraphrase positively" class="action-icon"/>\n                                            Positivize',T=m(),L=g("button"),L.innerHTML='<img src="./logos/add-ellipse-svgrepo-com.svg" alt="Add feedback as context" class="action-icon"/>\n                                            Select Context',S=m(),C=g("button"),C.innerHTML='<img src="./logos/note-svgrepo-com.svg" alt="Remove feedback" class="action-icon"/>\n                                            Add Note',N=m(),O=g("button"),O.innerHTML='<img src="./logos/delete-svgrepo-com.svg" alt="Remove feedback" class="action-icon"/>\n                                            Delete',j=m(),A=g("span"),M=g("input"),E=m(),w(n,"class","id-col svelte-o0vqi5"),w(p,"class","timestamp svelte-o0vqi5"),w(a,"class",""),w(r,"class","column feedback-col svelte-o0vqi5"),w(y,"class","centered speaker-col svelte-o0vqi5"),w(F,"class","action-button"),w(L,"class","action-button centered column"),w(C,"class","action-button"),w(O,"class","action-button"),w(q,"id","feedback-buttons"),w(q,"class","row centered spaced actions-col svelte-o0vqi5"),w(M,"type","checkbox"),w(A,"class","centered done-col svelte-o0vqi5"),w(t,"class","feedback-row row bordered padded svelte-o0vqi5"),$(t,"done",e[128].done),$(t,"selected",e[128]===e[11])},m(o,u){d(o,t,u),l(t,n),l(n,i),l(i,s),l(t,c),l(t,r),l(r,a),l(a,p),J.m(p,null),l(a,h),z.m(a,null),l(t,b),l(t,y),l(y,_),l(t,x),l(t,q),l(q,F),l(q,T),l(q,L),l(q,S),l(q,C),l(q,N),l(q,O),l(t,j),l(t,A),l(A,M),M.checked=e[128].done,l(t,E),H||(P=[v(p,"click",V),v(F,"click",G),v(L,"click",Y),v(C,"click",Q),v(O,"click",K),v(M,"change",X),v(t,"click",Z)],H=!0)},p(n,o){e=n,1&o[0]&&D!==(D=e[128].id+"")&&k(s,D),I===(I=U(e))&&J?J.p(e,o):(J.d(1),J=I(e),J&&(J.c(),J.m(p,null))),W===(W=B(e))&&z?z.p(e,o):(z.d(1),z=W(e),z&&(z.c(),z.m(a,null))),1&o[0]&&R!==(R=(e[128].speaker?e[128].speaker:"Unknown")+"")&&k(_,R),1&o[0]&&(M.checked=e[128].done),1&o[0]&&$(t,"done",e[128].done),2049&o[0]&&$(t,"selected",e[128]===e[11])},d(e){e&&u(t),J.d(),z.d(),H=!1,o(P)}}}function rt(t){let n;return{c(){n=f("[00:00:00]")},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function at(e){let t;function n(e,t){return"start_timestamp"in e[128].excerpt_reference?dt:lt}let o=n(e),i=o(e);return{c(){i.c(),t=h()},m(e,n){i.m(e,n),d(e,t,n)},p(e,s){o===(o=n(e))&&i?i.p(e,s):(i.d(1),i=o(e),i&&(i.c(),i.m(t.parentNode,t)))},d(e){i.d(e),e&&u(t)}}}function lt(t){let n;return{c(){n=f("[00:00:00]")},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function dt(e){let t,n,o,i=e[128].excerpt_reference.start_timestamp+"";return{c(){t=f("["),n=f(i),o=f("]")},m(e,i){d(e,t,i),d(e,n,i),d(e,o,i)},p(e,t){1&t[0]&&i!==(i=e[128].excerpt_reference.start_timestamp+"")&&k(n,i)},d(e){e&&u(t),e&&u(n),e&&u(o)}}}function ut(e){let t,n,o,i,s=e[128].quote+"",c=e[128].positivised_quote&&!e[128].show_paraphrased&&gt(e);return{c(){t=f('"'),n=f(s),o=f('" '),c&&c.c(),i=h()},m(e,s){d(e,t,s),d(e,n,s),d(e,o,s),c&&c.m(e,s),d(e,i,s)},p(e,t){1&t[0]&&s!==(s=e[128].quote+"")&&k(n,s),e[128].positivised_quote&&!e[128].show_paraphrased?c?c.p(e,t):(c=gt(e),c.c(),c.m(i.parentNode,i)):c&&(c.d(1),c=null)},d(e){e&&u(t),e&&u(n),e&&u(o),c&&c.d(e),e&&u(i)}}}function pt(e){let t,n,o,i,s,c,r,a=e[128].positivised_quote+"";function l(){return e[51](e[128])}return{c(){t=g("strong"),t.textContent="(Paraphrased Feedback)",n=f(' "'),o=f(a),i=f('" \n                                                '),s=g("span"),s.textContent="(View original quote)",w(s,"class","clickable svelte-o0vqi5")},m(e,a){d(e,t,a),d(e,n,a),d(e,o,a),d(e,i,a),d(e,s,a),c||(r=v(s,"click",l),c=!0)},p(t,n){e=t,1&n[0]&&a!==(a=e[128].positivised_quote+"")&&k(o,a)},d(e){e&&u(t),e&&u(n),e&&u(o),e&&u(i),e&&u(s),c=!1,r()}}}function gt(e){let t,n,o;function i(){return e[52](e[128])}return{c(){t=g("span"),t.textContent="(View paraphrased quote)",w(t,"class","clickable svelte-o0vqi5")},m(e,s){d(e,t,s),n||(o=v(t,"click",i),n=!0)},p(t,n){e=t},d(e){e&&u(t),n=!1,o()}}}function ft(e){let t,n="critical"===e[128].type&&ct(e);return{c(){n&&n.c(),t=h()},m(e,o){n&&n.m(e,o),d(e,t,o)},p(e,o){"critical"===e[128].type?n?n.p(e,o):(n=ct(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&u(t)}}}function mt(e){let t,n,o,i,s=e[126]+"";function c(){return e[61](e[111])}return{c(){t=g("button"),n=f(s),w(t,"class","tab svelte-o0vqi5"),$(t,"active",e[111]===e[12]),$(t,"right-bordered",e[111]<e[33].length-1)},m(e,s){d(e,t,s),l(t,n),o||(i=v(t,"click",c),o=!0)},p(n,o){e=n,4096&o[0]&&$(t,"active",e[111]===e[12])},d(e){e&&u(t),o=!1,i()}}}function ht(t){let n,i,s,c,r,a,p,f,h,b,k,y,x,q,F,T,L;function S(e,t){return e[3].length>0?kt:wt}let C=S(t),N=C(t),O=t[29]&&_t(t);function j(e,t){return 16&t[0]&&(F=null),null==F&&(F=!!(Object.keys(e[4]).length>0)),F?$t:xt}let A=j(t,[-1,-1,-1,-1,-1]),M=A(t);return{c(){n=g("div"),i=g("div"),s=g("div"),s.innerHTML='<span style="text-decoration: underline;"><strong>My Notes</strong></span>',c=m(),r=g("div"),N.c(),a=m(),O&&O.c(),p=m(),f=g("div"),h=g("button"),h.innerHTML='<img src="./logos/note-svgrepo-com.svg" alt="Add Note" class="action-icon"/>\n                                    Add Note',b=m(),k=g("button"),k.innerHTML='<img src="./logos/delete-svgrepo-com.svg" alt="Delete all notes" class="action-icon"/>\n                                    Delete all',y=m(),x=g("div"),x.innerHTML='<span style="text-decoration: underline;"><strong>My Feedback Notes</strong></span>',q=m(),M.c(),w(s,"class","row centered"),_(s,"width","100%"),_(s,"height","auto"),w(r,"class","column bordered"),_(r,"width","100%"),_(r,"height","auto"),$(r,"centered",t[3].length<=0),w(h,"class","action-button centered column"),w(k,"class","action-button centered column"),w(f,"class","row centered spaced"),w(i,"class","column centered spaced padded"),_(i,"width","100%"),_(i,"height","auto"),w(x,"class","row centered"),_(x,"width","100%"),_(x,"height","auto"),w(n,"class","column spaced padded"),_(n,"width","100%"),_(n,"height","100%"),_(n,"overflow-y","auto")},m(e,o){d(e,n,o),l(n,i),l(i,s),l(i,c),l(i,r),N.m(r,null),l(r,a),O&&O.m(r,null),l(i,p),l(i,f),l(f,h),l(f,b),l(f,k),l(n,y),l(n,x),l(n,q),M.m(n,null),T||(L=[v(h,"click",t[98]),v(k,"click",t[99])],T=!0)},p(e,t){C===(C=S(e))&&N?N.p(e,t):(N.d(1),N=C(e),N&&(N.c(),N.m(r,a))),e[29]?O?O.p(e,t):(O=_t(e),O.c(),O.m(r,null)):O&&(O.d(1),O=null),8&t[0]&&$(r,"centered",e[3].length<=0),A===(A=j(e,t))&&M?M.p(e,t):(M.d(1),M=A(e),M&&(M.c(),M.m(n,null)))},i:e,o:e,d(e){e&&u(n),N.d(),O&&O.d(),M.d(),T=!1,o(L)}}}function vt(e){let t,n,o,i,s,c,r,p,f,h,b,k;const y=[Nt,Ct],x=[];function $(e,t){return e[5]?1:0}return p=$(e),f=x[p]=y[p](e),{c(){t=g("div"),n=g("div"),o=g("button"),i=g("img"),r=m(),f.c(),w(i,"class","action-icon"),a(i.src,s=e[5]?"./logos/exit-svgrepo-com.svg":"./logos/settings-svgrepo-com.svg")||w(i,"src",s),w(i,"alt",c=e[5]?"Exit hatbot settings":"Open chatbot settings"),_(i,"width","2.5rem"),_(i,"height","2.5rem"),w(o,"class","action-button"),w(n,"id","chatbot-header"),w(n,"class","padded row svelte-o0vqi5"),w(t,"id","chatbot-tab-content"),w(t,"class","column svelte-o0vqi5")},m(s,c){d(s,t,c),l(t,n),l(n,o),l(o,i),l(t,r),x[p].m(t,null),h=!0,b||(k=v(o,"click",e[67]),b=!0)},p(e,n){(!h||32&n[0]&&!a(i.src,s=e[5]?"./logos/exit-svgrepo-com.svg":"./logos/settings-svgrepo-com.svg"))&&w(i,"src",s),(!h||32&n[0]&&c!==(c=e[5]?"Exit hatbot settings":"Open chatbot settings"))&&w(i,"alt",c);let o=p;p=$(e),p===o?x[p].p(e,n):(U(),V(x[o],1,1,(()=>{x[o]=null})),I(),f=x[p],f?f.p(e,n):(f=x[p]=y[p](e),f.c()),J(f,1),f.m(t,null))},i(e){h||(J(f),h=!0)},o(e){V(f),h=!1},d(e){e&&u(t),x[p].d(),b=!1,k()}}}function bt(t){let n,o,i,s;function c(e,t){return e[2]&&e[2].video?Gt:e[2]&&e[2].audio?zt:Wt}let r=c(t),a=r(t),p=t[2]&&t[2].transcript&&Yt(t);return{c(){n=g("div"),o=g("div"),a.c(),i=m(),s=g("div"),p&&p.c(),w(o,"id","media-player-area"),w(o,"class","bordered svelte-o0vqi5"),w(s,"id","transcript-area"),w(s,"class","column bordered spaced svelte-o0vqi5"),w(n,"class","column padded spaced"),_(n,"width","100%"),_(n,"height","100%")},m(e,t){d(e,n,t),l(n,o),a.m(o,null),l(n,i),l(n,s),p&&p.m(s,null)},p(e,t){r===(r=c(e))&&a?a.p(e,t):(a.d(1),a=r(e),a&&(a.c(),a.m(o,null))),e[2]&&e[2].transcript?p?p.p(e,t):(p=Yt(e),p.c(),p.m(s,null)):p&&(p.d(1),p=null)},i:e,o:e,d(e){e&&u(n),a.d(),p&&p.d()}}}function wt(t){let n;return{c(){n=g("div"),n.innerHTML="<span>No notes added. Feel free to add a note.</span>",w(n,"class","row padded space-between centered")},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function kt(e){let t,n=e[3],o=[];for(let t=0;t<n.length;t+=1)o[t]=yt(Pe(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=h()},m(e,n){for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,n);d(e,t,n)},p(e,i){if(8&i[0]|8192&i[1]){let s;for(n=e[3],s=0;s<n.length;s+=1){const c=Pe(e,n,s);o[s]?o[s].p(c,i):(o[s]=yt(c),o[s].c(),o[s].m(t.parentNode,t))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){p(o,e),e&&u(t)}}}function yt(e){let t,n,o,i,s,c,r,a,p,h,b,y=e[123]+"";function _(){return e[94](e[111],e[123])}return{c(){t=g("div"),n=g("p"),o=f(y),i=m(),s=g("div"),c=g("button"),c.textContent="Edit",r=m(),a=g("button"),a.textContent="Delete",p=m(),w(s,"class","row"),w(t,"class","row padded bordered space-between")},m(e,u){d(e,t,u),l(t,n),l(n,o),l(t,i),l(t,s),l(s,c),l(s,r),l(s,a),l(t,p),h||(b=v(a,"click",_),h=!0)},p(t,n){e=t,8&n[0]&&y!==(y=e[123]+"")&&k(o,y)},d(e){e&&u(t),h=!1,b()}}}function _t(e){let t,n,i,s,c,r,a,p,f;return{c(){t=g("div"),n=g("input"),i=m(),s=g("div"),c=g("button"),c.textContent="Confirm",r=m(),a=g("button"),a.textContent="Cancel",w(n,"type","text"),w(n,"placeholder","Enter your note here"),w(c,"class","action-button"),w(a,"class","action-button"),w(s,"class","row spaced"),w(t,"class","row padded bordered space-between"),_(t,"width","100%"),_(t,"height","auto")},m(o,u){d(o,t,u),l(t,n),y(n,e[30]),l(t,i),l(t,s),l(s,c),l(s,r),l(s,a),p||(f=[v(n,"input",e[95]),v(c,"click",e[96]),v(a,"click",e[97])],p=!0)},p(e,t){1073741824&t[0]&&n.value!==e[30]&&y(n,e[30])},d(e){e&&u(t),p=!1,o(f)}}}function xt(t){let n;return{c(){n=g("div"),n.innerHTML='<div class="row space-between centered" style="width:100%; height:auto;"><span>No feedback notes added. Feel free to add notes on your feedback by clicking &quot;Add Note&quot; on any of the critical feedback.</span></div>',w(n,"class","column centered spaced padded"),_(n,"width","100%"),_(n,"height","auto")},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function $t(e){let t,n=Object.keys(e[4]).map(Number).sort(Zt),o=[];for(let t=0;t<n.length;t+=1)o[t]=St(Ee(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=h()},m(e,n){for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,n);d(e,t,n)},p(e,i){if(1073741841&i[0]|24576&i[1]){let s;for(n=Object.keys(e[4]).map(Number).sort(Zt),s=0;s<n.length;s+=1){const c=Ee(e,n,s);o[s]?o[s].p(c,i):(o[s]=St(c),o[s].c(),o[s].m(t.parentNode,t))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){p(o,e),e&&u(t)}}}function qt(t){let n;return{c(){n=g("div"),n.innerHTML="<span>No notes added. Feel free to add a note.</span>",w(n,"class","row padded centered space-between")},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function Ft(e){let t,n=e[4][e[120]].notes,o=[];for(let t=0;t<n.length;t+=1)o[t]=Tt(He(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=h()},m(e,n){for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,n);d(e,t,n)},p(e,i){if(16&i[0]|8192&i[1]){let s;for(n=e[4][e[120]].notes,s=0;s<n.length;s+=1){const c=He(e,n,s);o[s]?o[s].p(c,i):(o[s]=Tt(c),o[s].c(),o[s].m(t.parentNode,t))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){p(o,e),e&&u(t)}}}function Tt(e){let t,n,o,i,s,c,r,a,p,h,b,y=e[123]+"";function _(){return e[101](e[111],e[120],e[123])}return{c(){t=g("div"),n=g("p"),o=f(y),i=m(),s=g("div"),c=g("button"),c.textContent="Edit",r=m(),a=g("button"),a.textContent="Delete",p=m(),w(c,"class","action-button"),w(a,"class","action-button"),w(s,"class","row spaced"),w(t,"class","row padded bordered space-between")},m(e,u){d(e,t,u),l(t,n),l(n,o),l(t,i),l(t,s),l(s,c),l(s,r),l(s,a),l(t,p),h||(b=v(a,"click",_),h=!0)},p(t,n){e=t,16&n[0]&&y!==(y=e[123]+"")&&k(o,y)},d(e){e&&u(t),h=!1,b()}}}function Lt(e){let t,n,i,s,c,r,a,p,f;function h(){return e[103](e[120])}function b(){return e[104](e[120])}return{c(){t=g("div"),n=g("input"),i=m(),s=g("div"),c=g("button"),c.textContent="Confirm",r=m(),a=g("button"),a.textContent="Cancel",w(n,"type","text"),w(n,"placeholder","Enter your note here"),w(c,"class","action=button"),w(a,"class","action=button"),w(s,"class","row spaced"),w(t,"class","row padded bordered space-between"),_(t,"width","100%"),_(t,"height","auto")},m(o,u){d(o,t,u),l(t,n),y(n,e[30]),l(t,i),l(t,s),l(s,c),l(s,r),l(s,a),p||(f=[v(n,"input",e[102]),v(c,"click",h),v(a,"click",b)],p=!0)},p(t,o){e=t,1073741824&o[0]&&n.value!==e[30]&&y(n,e[30])},d(e){e&&u(t),p=!1,o(f)}}}function St(e){let t,n,i,s,c,r,a,p,h,b,y,x,q,F,T,L,S,C,N,O,j,A,M,E,H=e[120]+"",P=e[0][e[120]-1].quote.slice(0,70)+"";function D(){return e[100](e[120])}function R(e,t){return e[4][e[120]].notes.length>0?Ft:qt}let U=R(e),I=U(e),J=e[4][e[120]].is_adding&&Lt(e);function V(){return e[105](e[120])}function B(){return e[106](e[120])}return{c(){t=g("div"),n=g("div"),i=g("span"),s=g("strong"),c=f("Feedback #"),r=f(H),a=f(" Notes:"),p=m(),h=f(P),b=f("..."),y=m(),x=g("button"),x.textContent="Delete",q=m(),F=g("div"),I.c(),T=m(),J&&J.c(),L=m(),S=g("div"),C=g("button"),C.innerHTML='<img src="./logos/note-svgrepo-com.svg" alt="Add Note" class="action-icon"/>\n                                            Add Note',N=m(),O=g("button"),O.innerHTML='<img src="./logos/delete-svgrepo-com.svg" alt="Delete all notes" class="action-icon"/>\n                                            Delete all',j=m(),w(n,"class","row space-between"),_(n,"width","100%"),_(n,"height","auto"),w(F,"class","column bordered"),_(F,"width","100%"),_(F,"height","auto"),$(F,"centered",e[4][e[120]].notes.length<=0),w(C,"class","action-button centered column"),w(O,"class","action-button centered column"),w(S,"class","row centered spaced"),w(t,"id",A="feedback-note-section-"+e[120]),w(t,"class","column centered spaced padded svelte-o0vqi5"),_(t,"width","100%"),_(t,"height","auto")},m(e,o){d(e,t,o),l(t,n),l(n,i),l(i,s),l(s,c),l(s,r),l(s,a),l(i,p),l(i,h),l(i,b),l(n,y),l(n,x),l(t,q),l(t,F),I.m(F,null),l(F,T),J&&J.m(F,null),l(t,L),l(t,S),l(S,C),l(S,N),l(S,O),l(t,j),M||(E=[v(x,"click",D),v(C,"click",V),v(O,"click",B)],M=!0)},p(n,o){e=n,16&o[0]&&H!==(H=e[120]+"")&&k(r,H),17&o[0]&&P!==(P=e[0][e[120]-1].quote.slice(0,70)+"")&&k(h,P),U===(U=R(e))&&I?I.p(e,o):(I.d(1),I=U(e),I&&(I.c(),I.m(F,T))),e[4][e[120]].is_adding?J?J.p(e,o):(J=Lt(e),J.c(),J.m(F,null)):J&&(J.d(1),J=null),16&o[0]&&$(F,"centered",e[4][e[120]].notes.length<=0),16&o[0]&&A!==(A="feedback-note-section-"+e[120])&&w(t,"id",A)},d(e){e&&u(t),I.d(),J&&J.d(),M=!1,o(E)}}}function Ct(e){let t,n,i,s,c,r,h,b,k,y,q,F,T,S,C,N,O,M,E,H,P,D,R,U,I,Y,Q,K,X,Z,te,ne,oe,ie,se,ce,re,ae,le,de,ue,pe,ge,fe,me,he,ve=Object.keys(e[31]),be=[];for(let t=0;t<ve.length;t+=1)be[t]=Ot(Re(e,ve,t));function we(t){e[85](t)}let ke={min:"0.0",max:"2.0",step:"0.1"};function ye(t){e[86](t)}void 0!==e[7]&&(ke.value=e[7]),T=new Me({props:ke}),L.push((()=>B(T,"value",we)));let _e={min:"10.0",max:"4095.0",step:"1.0"};function xe(t){e[87](t)}function $e(t){e[88](t)}void 0!==e[8]&&(_e.value=e[8]),E=new Me({props:_e}),L.push((()=>B(E,"value",ye)));let qe={};function Fe(e,t){return e[1].length>0?At:jt}void 0!==e[25]&&(qe.progress=e[25]),void 0!==e[24]&&(qe.status=e[24]),Q=new ee({props:qe}),L.push((()=>B(Q,"progress",xe))),L.push((()=>B(Q,"status",$e)));let Te=Fe(e),Le=Te(e);return{c(){t=g("div"),n=g("div"),i=g("span"),i.innerHTML="<strong>Configurations</strong>",s=m(),c=g("div"),r=g("span"),r.textContent="Model:",h=m(),b=g("select");for(let e=0;e<be.length;e+=1)be[e].c();k=m(),y=g("div"),q=g("span"),q.textContent="Temperature:",F=m(),W(T.$$.fragment),C=m(),N=g("div"),O=g("span"),O.textContent="Max Output Tokens:",M=m(),W(E.$$.fragment),P=m(),D=g("div"),R=g("span"),R.innerHTML="<strong>Chatbot&#39;s Resources</strong>",U=m(),I=g("div"),Y=g("div"),W(Q.$$.fragment),Z=m(),Le.c(),te=m(),ne=g("div"),oe=g("input"),ie=m(),se=g("button"),ce=g("img"),ae=f("\n                                            Add Document"),le=m(),de=g("button"),ue=g("img"),ge=f("\n                                            Remove All"),void 0===e[6]&&j((()=>e[84].call(b))),w(c,"class","row spaced centered"),_(c,"height","auto"),_(c,"width","100%"),w(y,"class","row spaced"),_(y,"height","auto"),_(y,"width","100%"),w(N,"class","row spaced"),_(N,"height","auto"),_(N,"width","100%"),w(n,"id","chatbot-configurations"),w(n,"class","column centered spaced padded bordered"),w(Y,"class","overlay centered padded"),$(Y,"invisible",!1===e[26]),w(I,"id","chatbot-rag-sources"),w(I,"class","column centered spaced padded bordered"),_(I,"width","100%"),_(I,"height","auto"),_(I,"overflow-y","auto"),w(oe,"type","file"),w(oe,"id","document_file_input"),w(oe,"class","gone"),a(ce.src,re="./logos/add-ellipse-svgrepo-com.svg")||w(ce,"src","./logos/add-ellipse-svgrepo-com.svg"),w(ce,"alt","Add document"),w(ce,"class","action-icon"),se.disabled=e[26],w(se,"class","centered spaced column action-button"),a(ue.src,pe="./logos/delete-svgrepo-com.svg")||w(ue,"src","./logos/delete-svgrepo-com.svg"),w(ue,"alt","Remove all documents"),w(ue,"class","action-icon"),de.disabled=e[26],w(de,"class","centered spaced column action-button"),w(ne,"id","chatbot-rag-buttons"),w(ne,"class","row centered padded spaced"),_(ne,"width","100%"),_(ne,"height","auto"),w(D,"id","chatbot-rag-panel"),w(D,"class","column centered spaced padded bordered"),w(t,"id","chatbot-settings"),w(t,"class","column padded spaced"),_(t,"width","100%"),_(t,"height","95%")},m(o,a){d(o,t,a),l(t,n),l(n,i),l(n,s),l(n,c),l(c,r),l(c,h),l(c,b);for(let e=0;e<be.length;e+=1)be[e]&&be[e].m(b,null);x(b,e[6],!0),l(n,k),l(n,y),l(y,q),l(y,F),z(T,y,null),l(n,C),l(n,N),l(N,O),l(N,M),z(E,N,null),l(t,P),l(t,D),l(D,R),l(D,U),l(D,I),l(I,Y),z(Q,Y,null),l(I,Z),Le.m(I,null),l(D,te),l(D,ne),l(ne,oe),e[90](oe),l(ne,ie),l(ne,se),l(se,ce),l(se,ae),l(ne,le),l(ne,de),l(de,ue),l(de,ge),fe=!0,me||(he=[v(b,"change",e[84]),v(oe,"change",e[91]),v(se,"click",e[92]),v(de,"click",e[93])],me=!0)},p(e,t){if(1&t[1]){let n;for(ve=Object.keys(e[31]),n=0;n<ve.length;n+=1){const o=Re(e,ve,n);be[n]?be[n].p(o,t):(be[n]=Ot(o),be[n].c(),be[n].m(b,null))}for(;n<be.length;n+=1)be[n].d(1);be.length=ve.length}64&t[0]|1&t[1]&&x(b,e[6]);const n={};!S&&128&t[0]&&(S=!0,n.value=e[7],A((()=>S=!1))),T.$set(n);const o={};!H&&256&t[0]&&(H=!0,o.value=e[8],A((()=>H=!1))),E.$set(o);const i={};!K&&33554432&t[0]&&(K=!0,i.progress=e[25],A((()=>K=!1))),!X&&16777216&t[0]&&(X=!0,i.status=e[24],A((()=>X=!1))),Q.$set(i),(!fe||67108864&t[0])&&$(Y,"invisible",!1===e[26]),Te===(Te=Fe(e))&&Le?Le.p(e,t):(Le.d(1),Le=Te(e),Le&&(Le.c(),Le.m(I,null))),(!fe||67108864&t[0])&&(se.disabled=e[26]),(!fe||67108864&t[0])&&(de.disabled=e[26])},i(e){fe||(J(T.$$.fragment,e),J(E.$$.fragment,e),J(Q.$$.fragment,e),fe=!0)},o(e){V(T.$$.fragment,e),V(E.$$.fragment,e),V(Q.$$.fragment,e),fe=!1},d(n){n&&u(t),p(be,n),G(T),G(E),G(Q),Le.d(),e[90](null),me=!1,o(he)}}}function Nt(e){let t,n,i,s,c,r,f,h,k,x,q,F,T,S,C,N,O,j,M,E,H,P,D,R,U,I,Y,Q,K,X,Z,te,ne,oe,ie,se,ce,re,ae,le,de,ue,pe,ge,fe,me,he,ve=e[14],be=[];for(let t=0;t<ve.length;t+=1)be[t]=Ut(Ue(e,ve,t));function we(t){e[71](t)}function ke(t){e[72](t)}let ye={};function _e(e,t){return e[15]?Jt:It}void 0!==e[23]&&(ye.progress=e[23]),void 0!==e[22]&&(ye.status=e[22]),h=new ee({props:ye}),L.push((()=>B(h,"progress",we))),L.push((()=>B(h,"status",ke)));let xe=_e(e),$e=xe(e);function qe(e,t){return e[17]?Bt:Vt}let Fe=qe(e),Te=Fe(e);return{c(){t=g("div"),n=g("div"),n.innerHTML="<p><strong>assistant:</strong> Hello! How can I help you today?</p>",i=m();for(let e=0;e<be.length;e+=1)be[e].c();s=m(),c=g("div"),r=g("p"),r.innerHTML="<strong>assistant:</strong>",f=m(),W(h.$$.fragment),q=m(),F=g("div"),T=m(),S=g("div"),C=g("div"),N=g("div"),O=g("span"),O.innerHTML="<strong>Feedback Context:</strong>",j=m(),$e.c(),E=m(),H=g("div"),P=g("span"),P.innerHTML="<strong>Suggested messages:</strong>",D=m(),R=g("div"),R.textContent="Explain feedback.",U=m(),I=g("div"),I.textContent="Brainstorm actions.",Q=m(),K=g("div"),Te.c(),Z=m(),te=g("div"),ne=g("div"),oe=g("label"),ie=m(),se=g("input"),ce=m(),re=g("button"),re.innerHTML='<img src="./logos/image-svgrepo-com.svg" alt="Attach image" class="action-icon"/>',ae=m(),le=g("textarea"),de=m(),ue=g("button"),pe=g("img"),w(n,"class","assistant padded svelte-o0vqi5"),w(c,"class","assistant padded column svelte-o0vqi5"),$(c,"invisible",!1===e[21]),_(F,"height","20%"),_(F,"width","100%"),_(F,"background-color","white"),_(F,"color","white"),_(F,"cursor","default"),w(t,"id","chatbot-messages"),w(t,"class","column spaced bordered padded svelte-o0vqi5"),w(N,"id","contexts"),w(N,"class","column centered bordered svelte-o0vqi5"),w(N,"style",M=e[17]?"width:30%;":"width:45%;"),w(R,"class","suggested-message svelte-o0vqi5"),w(I,"class","suggested-message svelte-o0vqi5"),w(H,"id","suggested-messages"),w(H,"class","column centered bordered svelte-o0vqi5"),w(H,"style",Y=e[17]?"width:30%;":"width:45%;"),w(K,"id","visual-context"),w(K,"class","column centered bordered svelte-o0vqi5"),w(K,"style",X=e[17]?"width:30%;":"display:none;"),w(C,"id","chatbot-utilities"),w(C,"class","row centered spaced svelte-o0vqi5"),w(oe,"for","image_upload"),_(oe,"display","none"),w(se,"accept","image/png, image/jpeg"),w(se,"type","file"),_(se,"display","none"),w(se,"id","image_upload"),w(se,"name","image_upload"),w(re,"class","action-button centered column"),w(ne,"class","column spaced"),_(le,"width","100%"),_(le,"height","100%"),w(le,"placeholder","Type your message here..."),w(le,"id","textarea"),a(pe.src,ge="./logos/send-svgrepo-com.svg")||w(pe,"src","./logos/send-svgrepo-com.svg"),w(pe,"alt","Send"),w(pe,"class","action-icon"),w(ue,"class","action-button centered column"),ue.disabled=e[21],w(te,"id","chatbot-input"),w(te,"class","row spaced centered svelte-o0vqi5"),w(S,"id","chatbot-actions"),w(S,"class","column padded spaced centered svelte-o0vqi5")},m(o,a){d(o,t,a),l(t,n),l(t,i);for(let e=0;e<be.length;e+=1)be[e]&&be[e].m(t,null);l(t,s),l(t,c),l(c,r),l(c,f),z(h,c,null),l(t,q),l(t,F),d(o,T,a),d(o,S,a),l(S,C),l(C,N),l(N,O),l(N,j),$e.m(N,null),l(C,E),l(C,H),l(H,P),l(H,D),l(H,R),l(H,U),l(H,I),l(C,Q),l(C,K),Te.m(K,null),l(S,Z),l(S,te),l(te,ne),l(ne,oe),l(ne,ie),l(ne,se),e[78](se),l(ne,ce),l(ne,re),l(te,ae),l(te,le),y(le,e[10]),l(te,de),l(te,ue),l(ue,pe),fe=!0,me||(he=[v(R,"click",b(e[74])),v(I,"click",b(e[75])),v(se,"change",e[77]),v(se,"change",e[79]),v(re,"click",b(e[80])),v(le,"input",e[81]),v(le,"keydown",e[82]),v(ue,"click",b(e[83]))],me=!0)},p(e,n){if(20480&n[0]|4096&n[1]){let o;for(ve=e[14],o=0;o<ve.length;o+=1){const i=Ue(e,ve,o);be[o]?be[o].p(i,n):(be[o]=Ut(i),be[o].c(),be[o].m(t,s))}for(;o<be.length;o+=1)be[o].d(1);be.length=ve.length}const o={};!k&&8388608&n[0]&&(k=!0,o.progress=e[23],A((()=>k=!1))),!x&&4194304&n[0]&&(x=!0,o.status=e[22],A((()=>x=!1))),h.$set(o),(!fe||2097152&n[0])&&$(c,"invisible",!1===e[21]),xe===(xe=_e(e))&&$e?$e.p(e,n):($e.d(1),$e=xe(e),$e&&($e.c(),$e.m(N,null))),(!fe||131072&n[0]&&M!==(M=e[17]?"width:30%;":"width:45%;"))&&w(N,"style",M),(!fe||131072&n[0]&&Y!==(Y=e[17]?"width:30%;":"width:45%;"))&&w(H,"style",Y),Fe===(Fe=qe(e))&&Te?Te.p(e,n):(Te.d(1),Te=Fe(e),Te&&(Te.c(),Te.m(K,null))),(!fe||131072&n[0]&&X!==(X=e[17]?"width:30%;":"display:none;"))&&w(K,"style",X),1024&n[0]&&y(le,e[10]),(!fe||2097152&n[0])&&(ue.disabled=e[21])},i(e){fe||(J(h.$$.fragment,e),fe=!0)},o(e){V(h.$$.fragment,e),fe=!1},d(n){n&&u(t),p(be,n),G(h),n&&u(T),n&&u(S),$e.d(),Te.d(),e[78](null),me=!1,o(he)}}}function Ot(t){let n,o,i=t[117]+"";return{c(){n=g("option"),o=f(i),n.__value=t[117],n.value=n.__value},m(e,t){d(e,n,t),l(n,o)},p:e,d(e){e&&u(n)}}}function jt(t){let n;return{c(){n=g("span"),n.textContent="No resources available."},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function At(e){let t,n=e[1],o=[];for(let t=0;t<n.length;t+=1)o[t]=Mt(De(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=h()},m(e,n){for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,n);d(e,t,n)},p(e,i){if(117440514&i[0]|1024&i[1]){let s;for(n=e[1],s=0;s<n.length;s+=1){const c=De(e,n,s);o[s]?o[s].p(c,i):(o[s]=Mt(c),o[s].c(),o[s].m(t.parentNode,t))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){p(o,e),e&&u(t)}}}function Mt(e){let t,n,o,i,s,c,r,p,h,y=e[115]+"";function _(){return e[89](e[115],e[111])}return{c(){t=g("div"),n=f(y),o=m(),i=g("button"),s=g("img"),r=m(),a(s.src,c="./logos/delete-x-svgrepo-com.svg")||w(s,"src","./logos/delete-x-svgrepo-com.svg"),w(s,"alt","Remove document"),w(s,"class","mini-icon"),i.disabled=e[26],w(i,"class","action-button"),w(t,"class","row centered spaced bordered centered")},m(e,c){d(e,t,c),l(t,n),l(t,o),l(t,i),l(i,s),l(t,r),p||(h=v(i,"click",b(_)),p=!0)},p(t,o){e=t,2&o[0]&&y!==(y=e[115]+"")&&k(n,y),67108864&o[0]&&(i.disabled=e[26])},d(e){e&&u(t),p=!1,h()}}}function Et(e){let t,n,i,s,c,r,a,p,h,b,y,_,x,$,q,F,T,L,S,C,N,O,j,A=e[112].role+"",M=e[112].content+"",E="context"in e[112]&&Ht(e),H="image"in e[112]&&Pt(e);function P(){return e[68](e[112])}let D="context"in e[112]&&Dt(e);function R(){return e[70](e[112])}let U="image"in e[112]&&"user"===e[112].role&&Rt(e);return{c(){t=g("div"),n=g("div"),i=g("div"),E&&E.c(),s=m(),H&&H.c(),c=m(),r=g("div"),a=g("button"),a.innerHTML='<img src="./logos/note-svgrepo-com.svg" alt="Add to my notes" class="mini-icon"/>',p=m(),D&&D.c(),h=m(),b=g("button"),b.innerHTML='<img src="./logos/copy-svgrepo-com.svg" alt="Copy note" class="mini-icon"/>',_=m(),x=g("div"),$=g("p"),q=g("strong"),F=f(A),T=f(":"),L=m(),S=f(M),C=m(),U&&U.c(),w(i,"class","row spaced"),w(a,"class","action-button column centered"),w(b,"class","action-button column centered"),w(r,"class","row spaced"),w(n,"class",y="message-header row "+("context"in e[112]||"image"in e[112]?"with-context":"no-context")+" svelte-o0vqi5"),w(x,"class","row"),w(t,"class",N=e[112].role+" padded column spaced svelte-o0vqi5")},m(e,o){d(e,t,o),l(t,n),l(n,i),E&&E.m(i,null),l(i,s),H&&H.m(i,null),l(n,c),l(n,r),l(r,a),l(r,p),D&&D.m(r,null),l(r,h),l(r,b),l(t,_),l(t,x),l(x,$),l($,q),l(q,F),l(q,T),l($,L),l($,S),l(t,C),U&&U.m(t,null),O||(j=[v(a,"click",P),v(b,"click",R)],O=!0)},p(o,c){"context"in(e=o)[112]?E?E.p(e,c):(E=Ht(e),E.c(),E.m(i,s)):E&&(E.d(1),E=null),"image"in e[112]?H?H.p(e,c):(H=Pt(e),H.c(),H.m(i,null)):H&&(H.d(1),H=null),"context"in e[112]?D?D.p(e,c):(D=Dt(e),D.c(),D.m(r,h)):D&&(D.d(1),D=null),16384&c[0]&&y!==(y="message-header row "+("context"in e[112]||"image"in e[112]?"with-context":"no-context")+" svelte-o0vqi5")&&w(n,"class",y),16384&c[0]&&A!==(A=e[112].role+"")&&k(F,A),16384&c[0]&&M!==(M=e[112].content+"")&&k(S,M),"image"in e[112]&&"user"===e[112].role?U?U.p(e,c):(U=Rt(e),U.c(),U.m(t,null)):U&&(U.d(1),U=null),16384&c[0]&&N!==(N=e[112].role+" padded column spaced svelte-o0vqi5")&&w(t,"class",N)},d(e){e&&u(t),E&&E.d(),H&&H.d(),D&&D.d(),U&&U.d(),O=!1,o(j)}}}function Ht(e){let t,n,o,i,s,c,r=e[112].context.id+"",a=(e[112].context.quote.length>40?e[112].context.quote.slice(0,40)+"...":e[112].context.quote)+"";return{c(){t=g("div"),n=g("small"),o=f("Context: F#"),i=f(r),s=m(),c=f(a),w(t,"class","context-tag feedback svelte-o0vqi5")},m(e,r){d(e,t,r),l(t,n),l(n,o),l(n,i),l(n,s),l(n,c)},p(e,t){16384&t[0]&&r!==(r=e[112].context.id+"")&&k(i,r),16384&t[0]&&a!==(a=(e[112].context.quote.length>40?e[112].context.quote.slice(0,40)+"...":e[112].context.quote)+"")&&k(c,a)},d(e){e&&u(t)}}}function Pt(e){let t,n,o,i="user"===e[112].role?"Attached image":"Response to image";return{c(){t=g("div"),n=g("small"),o=f(i),w(t,"class","context-tag image svelte-o0vqi5")},m(e,i){d(e,t,i),l(t,n),l(n,o)},p(e,t){16384&t[0]&&i!==(i="user"===e[112].role?"Attached image":"Response to image")&&k(o,i)},d(e){e&&u(t)}}}function Dt(e){let t,n,o;function i(){return e[69](e[112])}return{c(){t=g("button"),t.innerHTML='<img src="./logos/note-svgrepo-com.svg" alt="Add feedback note" class="mini-icon"/>',w(t,"class","action-button column centered")},m(e,s){d(e,t,s),n||(o=v(t,"click",i),n=!0)},p(t,n){e=t},d(e){e&&u(t),n=!1,o()}}}function Rt(e){let t,n,o;return{c(){t=g("div"),n=g("img"),a(n.src,o=e[112].image)||w(n,"src",o),w(n,"alt","Visual context"),_(n,"width","50%"),_(n,"height","auto"),w(t,"class","column centered"),_(t,"width","100%")},m(e,o){d(e,t,o),l(t,n)},p(e,t){16384&t[0]&&!a(n.src,o=e[112].image)&&w(n,"src",o)},d(e){e&&u(t)}}}function Ut(e){let t,n="system"!=e[112].role&&Et(e);return{c(){n&&n.c(),t=h()},m(e,o){n&&n.m(e,o),d(e,t,o)},p(e,o){"system"!=e[112].role?n?n.p(e,o):(n=Et(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&u(t)}}}function It(t){let n;return{c(){n=g("span"),n.textContent="None. Add by selecting from the feedback."},m(e,t){d(e,n,t)},p:e,d(e){e&&u(n)}}}function Jt(e){let t,n,o,i,s,c,r,a,p,h,y,_=e[15].id+"",x=e[15].quote.slice(0,30)+"";return{c(){t=g("div"),n=g("span"),o=f("F#"),i=f(_),s=f(":"),c=f(x),r=f("..."),a=m(),p=g("button"),p.innerHTML='<img src="./logos/delete-x-svgrepo-com.svg" alt="Remove context" class="mini-icon"/>',w(t,"class","suggested-message row  svelte-o0vqi5")},m(u,g){d(u,t,g),l(t,n),l(n,o),l(n,i),l(n,s),l(n,c),l(n,r),l(t,a),l(t,p),h||(y=v(p,"click",b(e[73])),h=!0)},p(e,t){32768&t[0]&&_!==(_=e[15].id+"")&&k(i,_),32768&t[0]&&x!==(x=e[15].quote.slice(0,30)+"")&&k(c,x)},d(e){e&&u(t),h=!1,y()}}}function Vt(t){return{c:e,m:e,p:e,d:e}}function Bt(e){let t,n,o,i,s,c,r,p,f;return{c(){t=g("span"),t.innerHTML="<strong>Attached image:</strong>",n=m(),o=g("div"),i=g("img"),c=m(),r=g("button"),r.innerHTML='<img src="./logos/delete-x-svgrepo-com.svg" alt="Remove image" class="mini-icon"/>',a(i.src,s=e[17])||w(i,"src",s),w(i,"alt","Visual context"),_(i,"width","100%"),_(i,"height","100%"),w(o,"class","row"),_(o,"width","100%"),_(o,"height","100%")},m(s,a){d(s,t,a),d(s,n,a),d(s,o,a),l(o,i),l(o,c),l(o,r),p||(f=v(r,"click",b(e[76])),p=!0)},p(e,t){131072&t[0]&&!a(i.src,s=e[17])&&w(i,"src",s)},d(e){e&&u(t),e&&u(n),e&&u(o),p=!1,f()}}}function Wt(t){let n,o;return{c(){n=g("video"),n.innerHTML='<track kind="captions" src="blank.vtt" srclang="en"/>',a(n.src,o="video.mp4")||w(n,"src","video.mp4"),n.controls=!0,_(n,"width","100%"),_(n,"height","100%")},m(e,o){d(e,n,o),t[64](n)},p:e,d(e){e&&u(n),t[64](null)}}}function zt(e){let t,n;return{c(){t=g("audio"),a(t.src,n=e[2].audio)||w(t,"src",n),t.controls=!0,_(t,"width","100%"),_(t,"height","100%")},m(n,o){d(n,t,o),e[63](t)},p(e,o){4&o[0]&&!a(t.src,n=e[2].audio)&&w(t,"src",n)},d(n){n&&u(t),e[63](null)}}}function Gt(e){let t,n,o,i;return{c(){t=g("video"),n=g("track"),w(n,"kind","captions"),a(n.src,o="blank.vtt")||w(n,"src","blank.vtt"),w(n,"srclang","en"),a(t.src,i=e[2].video)||w(t,"src",i),t.controls=!0,_(t,"width","100%"),_(t,"height","100%")},m(o,i){d(o,t,i),l(t,n),e[62](t)},p(e,n){4&n[0]&&!a(t.src,i=e[2].video)&&w(t,"src",i)},d(n){n&&u(t),e[62](null)}}}function Yt(e){let t,n=e[2].transcript_list,o=[];for(let t=0;t<n.length;t+=1)o[t]=Qt(Ie(e,n,t));return{c(){t=g("p");for(let e=0;e<o.length;e+=1)o[e].c();w(t,"class","spaced padded")},m(e,n){d(e,t,n);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null)},p(e,i){if(516&i[0]){let s;for(n=e[2].transcript_list,s=0;s<n.length;s+=1){const c=Ie(e,n,s);o[s]?o[s].p(c,i):(o[s]=Qt(c),o[s].c(),o[s].m(t,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){e&&u(t),p(o,e)}}}function Qt(e){let t,n,i,s,c,r,a,p,h,b,y,_,x,$,q,F,T,L,S,C,N,O=e[109].start_timestamp+"",j=e[109].end_timestamp+"",A=e[109].speaker?e[109].speaker+":":"",M=e[109].dialogue+"";function E(){return e[65](e[109])}function H(){return e[66](e[109])}return{c(){t=g("span"),n=f("["),i=f(O),s=f("]"),c=f(" - "),r=g("span"),a=f("["),p=f(j),h=f("]"),b=m(),y=g("br"),_=m(),x=f(A),$=m(),q=g("span"),T=m(),L=g("br"),S=g("br"),w(t,"class","timestamp svelte-o0vqi5"),w(r,"class","timestamp svelte-o0vqi5"),w(q,"id",F=e[109].id),w(q,"class","svelte-o0vqi5")},m(e,o){d(e,t,o),l(t,n),l(t,i),l(t,s),d(e,c,o),d(e,r,o),l(r,a),l(r,p),l(r,h),d(e,b,o),d(e,y,o),d(e,_,o),d(e,x,o),d(e,$,o),d(e,q,o),q.innerHTML=M,d(e,T,o),d(e,L,o),d(e,S,o),C||(N=[v(t,"click",E),v(r,"click",H)],C=!0)},p(t,n){e=t,4&n[0]&&O!==(O=e[109].start_timestamp+"")&&k(i,O),4&n[0]&&j!==(j=e[109].end_timestamp+"")&&k(p,j),4&n[0]&&A!==(A=e[109].speaker?e[109].speaker+":":"")&&k(x,A),4&n[0]&&M!==(M=e[109].dialogue+"")&&(q.innerHTML=M),4&n[0]&&F!==(F=e[109].id)&&w(q,"id",F)},d(e){e&&u(t),e&&u(c),e&&u(r),e&&u(b),e&&u(y),e&&u(_),e&&u(x),e&&u($),e&&u(q),e&&u(T),e&&u(L),e&&u(S),C=!1,o(N)}}}function Kt(e){let t,n,o,i,s,c,r,a,f,h,b,k,y,x,$,q,F,T=e[32],L=[];for(let t=0;t<T.length;t+=1)L[t]=ze(We(e,T,t));function S(e,t){return 0===e[13]?Ye:1===e[13]?Ge:void 0}let C=S(e),N=C&&C(e),O=e[33],j=[];for(let t=0;t<O.length;t+=1)j[t]=mt(Je(e,O,t));const A=[bt,vt,ht],M=[];function E(e,t){return 0===e[12]?0:1===e[12]?1:2===e[12]?2:-1}return~(y=E(e))&&(x=M[y]=A[y](e)),{c(){t=g("div"),n=g("div"),o=g("div"),i=g("div");for(let e=0;e<L.length;e+=1)L[e].c();s=m(),c=g("div"),N&&N.c(),r=m(),a=g("div"),f=g("div"),h=g("div");for(let e=0;e<j.length;e+=1)j[e].c();b=m(),k=g("div"),x&&x.c(),w(i,"class","tab-header svelte-o0vqi5"),w(c,"class","tab-content padded svelte-o0vqi5"),_(c,"overflow-y","auto"),w(o,"class","tabbed-area bordered svelte-o0vqi5"),w(n,"id","left-panel"),w(n,"class","column svelte-o0vqi5"),w(h,"class","tab-header svelte-o0vqi5"),w(k,"class","tab-content column svelte-o0vqi5"),w(f,"class","tabbed-area bordered svelte-o0vqi5"),w(a,"id","right-panel"),w(a,"class","column  svelte-o0vqi5"),w(t,"id","feedback-list-page"),w(t,"class","spaced svelte-o0vqi5")},m(u,p){d(u,t,p),l(t,n),l(n,o),l(o,i);for(let e=0;e<L.length;e+=1)L[e]&&L[e].m(i,null);l(o,s),l(o,c),N&&N.m(c,null),l(t,r),l(t,a),l(a,f),l(f,h);for(let e=0;e<j.length;e+=1)j[e]&&j[e].m(h,null);l(f,b),l(f,k),~y&&M[y].m(k,null),$=!0,q||(F=v(t,"window:click",e[36]),q=!0)},p(e,t){if(8192&t[0]|2&t[1]){let n;for(T=e[32],n=0;n<T.length;n+=1){const o=We(e,T,n);L[n]?L[n].p(o,t):(L[n]=ze(o),L[n].c(),L[n].m(i,null))}for(;n<L.length;n+=1)L[n].d(1);L.length=T.length}if(C===(C=S(e))&&N?N.p(e,t):(N&&N.d(1),N=C&&C(e),N&&(N.c(),N.m(c,null))),4096&t[0]|4&t[1]){let n;for(O=e[33],n=0;n<O.length;n+=1){const o=Je(e,O,n);j[n]?j[n].p(o,t):(j[n]=mt(o),j[n].c(),j[n].m(h,null))}for(;n<j.length;n+=1)j[n].d(1);j.length=O.length}let n=y;y=E(e),y===n?~y&&M[y].p(e,t):(x&&(U(),V(M[n],1,1,(()=>{M[n]=null})),I()),~y?(x=M[y],x?x.p(e,t):(x=M[y]=A[y](e),x.c()),J(x,1),x.m(k,null)):x=null)},i(e){$||(J(x),$=!0)},o(e){V(x),$=!1},d(e){e&&u(t),p(L,e),N&&N.d(),p(j,e),~y&&M[y].d(),q=!1,F()}}}function Xt(e,t=!0){e.show_paraphrased=t}const Zt=(e,t)=>e-t;function en(e,t,n){let o,i,s,c,r,a,l,d,{feedback_list:u}=t,{recording:p}=t,{documents:g=[]}=t,f=[],m={1:{notes:["This is a note","This is another note"],is_adding:!1},2:{notes:["This is a note","This is another note"],is_adding:!1},3:{notes:["This is a note","This is another note"],is_adding:!1}},h=!1,v={"GPT-4o":"gpt-4o","Interior Designer GPT":"ft:gpt-3.5-turbo-0125:im-lab:int-des-full:9b2qf12W"},b="GPT-4o",w=0,k=256,y="",_=0,x=0,$=[{content:"You are an expert senior interior designer who is tasked to assist less experienced interior designers like students and junior interior designers with their work by answering their questions on a wide range of interior design topics. ",role:"system"}],q=["Critical Feedback","Positive Feedback"],F=["Transcript","Chatbot","Notes"],T=!1,S="",C=0,N="",O=0,j=!1;function A(e){i===e&&n(11,i=null),n(0,u=u.filter((t=>t!==e))),n(0,u)}function M(e,t){n(11,i=e),t.stopPropagation()}let E=null,H=!0;function P(e){E===e?n(28,H=!H):(n(27,E=e),n(28,H=!0)),u.sort(((t,n)=>t[e]<n[e]?H?-1:1:t[e]>n[e]?H?1:-1:0)),n(0,u)}async function D(e,t=null){let o=e.slice();if(T)return void alert("Please wait for the current message to be processed.");if(n(21,T=!0),""===e.trim())return void alert("Please enter a message.");let i={role:"user",content:e};if(t){i.context=t;let e="\n\nHere is the piece of feedback as context.";e+="\nF#"+t.id+': "'+t.speaker+": "+t.quote+'".',o+=e}let s={message:o,image_data:null,max_output_tokens:k,temperature:w,model:v[b]};if(r&&(i.image=r),c){n(22,S="Uploading image..."),n(23,C=30);let e=await async function(e){return new Promise(((t,n)=>{const o=new FileReader;o.onload=()=>t(o.result),o.onerror=e=>n(e),o.readAsDataURL(e)}))}(c);s.image_data=e}$.push(i),n(14,$),console.log($),n(0,u),n(22,S="Thinking..."),n(23,C=50);const a=await fetch("/message_chatbot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to send message");let l=(await a.json()).chatbot_response;n(22,S="Done!"),n(23,C=100),await te(1200),await ne("FeedbackList: Sent message",[e,t,r]);let d={role:"assistant",content:l};t&&(d.context=t),r&&(d.image=r),$.push(d),n(14,$),n(0,u),n(21,T=!1),n(23,C=0)}function R(e){s===e?alert("This feedback is already added as context."):n(15,s=e)}async function U(e){const t=e.target.files;if(t)for(const e of t){const t=new FormData;t.append("file",e),n(25,O=50),n(24,N="Adding document... (this may take a while)");const o=await fetch("/add_document",{method:"POST",body:t});if(!o.ok)return null;let i=(await o.json()).document_name;g.push(i),n(1,g),n(24,N="Done!"),n(25,O=100),await te(1200)}}async function I(e,t){return(await fetch("/delete_document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e})})).ok?(n(1,g=g.splice(t,1)),n(1,g),e):"failed"}async function J(){n(24,N="Removing all documents...");for(let e=0;e<g.length;e++){let t=g[e];n(25,O=e/g.length*100),await I(t,e)}n(24,N="Done!"),n(25,O=100),await te(1e3),n(25,O=0)}let V=!1,B="";async function W(e,t=null,o=null){""!=e.trim()?t?t in m?(m[t].notes.push(e),n(4,m)):n(4,m[t]={notes:[e],is_adding:!1},m):(f.push(e),n(3,f)):alert("Please enter a note.")}async function z(e,t=null){t?(m[t].notes.splice(e,1),n(4,m)):(f.splice(e,1),n(3,f))}async function G(e=null){n(29,V=!1),W(B,e),n(30,B="")}return e.$$set=e=>{"feedback_list"in e&&n(0,u=e.feedback_list),"recording"in e&&n(2,p=e.recording),"documents"in e&&n(1,g=e.documents)},[u,g,p,f,m,h,b,w,k,o,y,i,_,x,$,s,c,r,a,l,d,T,S,C,N,O,j,E,H,V,B,v,q,F,A,M,function(){n(11,i=null)},P,D,R,U,I,J,W,z,G,async e=>{n(13,x=e),await ne("FeedbackList: Switched left panel tab",q[x])},async()=>{P("quote"),await ne("FeedbackList: Sorted feedback","quote")},async()=>{P("speaker"),await ne("FeedbackList: Sorted feedback","speaker")},async()=>{P("done"),await ne("FeedbackList: Sorted feedback","done")},async e=>{n(12,_=0),"excerpt_reference"in e&&"start_timestamp"in e.excerpt_reference&&(oe(e.excerpt_reference.start_timestamp,o),await ne("FeedbackList: Seeked to timestamp",e.excerpt_reference.start_timestamp))},async e=>{Xt(e,!1),await ne("FeedbackList: Show original quote",e.original_quote)},async e=>{Xt(e,!0),await ne("FeedbackList: Show paraphrased quote",e.positivised_quote)},async(e,t,o)=>{n(0,t[o].positivised_quote=await async function(e,t){const n=await fetch("/positively_paraphrase_feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({feedback:e,excerpt:t})});if(!n.ok)throw new Error("Failed to detect feedback");return(await n.json()).paraphrased_feedback}(e.quote,e.excerpt_reference.dialogue),u),Xt(e,!0),n(0,u),await ne("FeedbackList: Positivize Quote",e)},async e=>{R(e),await ne("FeedbackList: Add as context",s)},async e=>{n(12,_=2),e.id in m?n(4,m[e.id].is_adding=!0,m):n(4,m[e.id]={notes:[],is_adding:!0},m)},async e=>{A(e),await ne("FeedbackList: Remove feedback",e)},function(e,t){e[t].done=this.checked,n(0,u)},async(e,t)=>{M(e,t),ie(e),await ne("FeedbackList: Selected feedback",e)},async e=>{n(12,_=0),"excerpt_reference"in e&&"start_timestamp"in e.excerpt_reference&&(oe(e.excerpt_reference.start_timestamp,o),await ne("FeedbackList: Seeked to timestamp",e.excerpt_reference.start_timestamp))},async(e,t)=>{M(e,t),ie(e),await ne("FeedbackList: Selected feedback",e)},async e=>{n(12,_=e),await ne("FeedbackList: Switched right panel tab",F[_])},function(e){L[e?"unshift":"push"]((()=>{o=e,n(9,o)}))},function(e){L[e?"unshift":"push"]((()=>{o=e,n(9,o)}))},function(e){L[e?"unshift":"push"]((()=>{o=e,n(9,o)}))},async e=>{oe(e.start_timestamp,o),await ne("FeedbackList: Seek to start timestamp",e.start_timestamp)},async e=>{oe(e.end_timestamp,o),await ne("FeedbackList: Seek to end timestamp",e.end_timestamp)},async()=>{n(5,h=!h),await ne("FeedbackList: Toggled chatbot settings",h)},async e=>{n(12,_=2),W(e.role+": "+e.content),await ne("FeedbackList: Added note to My Notes",e)},async e=>{n(12,_=2),W(e.role+": "+e.content,"id"in e.context?e.context.id:null),await ne("FeedbackList: Added note to Feedback ID"+e.context.id,e)},async e=>{navigator.clipboard.writeText(e.role+": "+e.content),await ne("FeedbackList: Copied message",e)},function(e){C=e,n(23,C)},function(e){S=e,n(22,S)},async()=>{await ne("FeedbackList: Removed context",s),n(15,s=null)},async()=>{T||await D("Can you paraphrase the following feedback positively?",s)},async()=>{T||await D("Can you suggest a task to address the following feedback?",s)},async()=>{await ne("FeedbackList: Removed image",r),n(17,r=null),n(16,c=null)},function(){a=this.value,n(18,a)},function(e){L[e?"unshift":"push"]((()=>{l=e,n(19,l)}))},async()=>{n(18,a=l.files),n(17,[r,c]=await async function(e){let t=e[0];if(t){if(t.type.includes("image"))return[URL.createObjectURL(t),t];alert("Please select an image file.")}else console.log("No image selected.");return null}(a),r,n(16,c)),await ne(r?"FeedbackList: Uploaded image":"FeedbackList: Canceled uploading image",r)},async()=>{l.click()},function(){y=this.value,n(10,y)},e=>"Enter"===e.key&&D(y,s),async()=>{await D(y,s),n(10,y="")},function(){b=function(e){const t=e.querySelector(":checked");return t&&t.__value}(this),n(6,b),n(31,v)},function(e){w=e,n(7,w)},function(e){k=e,n(8,k)},function(e){O=e,n(25,O)},function(e){N=e,n(24,N)},async(e,t)=>{if(!window.confirm("Are you sure you want to delete this document? This cannot be undone."))return;n(26,j=!0),n(25,O=50),n(24,N="Removing document...");let o=await I(e,t);n(24,N="Done!"),n(25,O=100),n(26,j=!1),ne("FeedbackList: Removed document",o)},function(e){L[e?"unshift":"push"]((()=>{d=e,n(20,d)}))},async e=>{n(26,j=!0),await U(e),n(26,j=!1),ne("FeedbackList: Added document",e.target.files)},async()=>{window.confirm("Adding a new document will take a long time, since its information will be extracted. Do you want to proceed?")&&(document.getElementById("document_file_input").click(),await ne("FeedbackList: Added document","Document"))},async()=>{window.confirm("Are you sure you want to remove all documents? This cannot be undone.")&&(n(26,j=!0),await J(),n(26,j=!1),await ne("FeedbackList: Removed all documents",g))},async(e,t)=>{z(e),await ne("FeedbackList: Removed note",t)},function(){B=this.value,n(30,B)},async()=>{G(),n(29,V=!1),await ne("FeedbackList: Added note to My Notes",B)},async()=>{n(29,V=!1),n(30,B=""),await ne("FeedbackList: Cancelled adding note to My Notes",B)},async()=>{n(29,V=!0),await ne("FeedbackList: Clicked on My Notes' Add Note button",V)},async()=>{window.confirm("Are you sure you want to delete all notes? This cannot be undone.")&&(n(3,f=[]),n(3,f),await ne("FeedbackList: Removed all notes from My Notes",f))},async e=>{let t="Are you sure you want to delete this feedback notes section? This cannot be undone";m[e].notes.length>0&&(t="Are you sure you want to delete this feedback notes section? This will delete all notes and cannot be undone."),window.confirm(t)&&(delete m[e],n(4,m),await ne("FeedbackList: Removed feedback notes section","Feedback ID"+e))},async(e,t,n)=>{z(e,t),await ne("FeedbackList: Removed note from Feedback ID"+t,n)},function(){B=this.value,n(30,B)},async e=>{G(e),n(4,m[e].is_adding=!1,m),await ne("FeedbackList: Added note to Feedback ID"+e,B)},async e=>{n(4,m[e].is_adding=!1,m),await ne("FeedbackList: Cancelled adding note to Feedback ID"+e,B),n(30,B="")},async e=>{n(4,m[e].is_adding=!0,m),await ne("FeedbackList: Clicked on Feedback ID"+e+"'s Add Note button",m[e].is_adding)},async e=>{window.confirm("Are you sure you want to delete all notes? This cannot be undone.")&&(n(4,m[e].notes=[],m),n(4,m),await ne("FeedbackList: Removed all notes from Feedback ID"+e,m[e].notes))}]}class tn extends K{constructor(e){super(),Q(this,e,en,Kt,s,{feedback_list:0,recording:2,documents:1},null,[-1,-1,-1,-1,-1])}}function nn(e){let t,n,i,s,c,r,p,h,b,k,y,x,q,F,T,S,C,N,O,j,M,E,H,P,D,R,U,I;function Y(t){e[6](t)}function Q(t){e[7](t)}let K={};function X(t){e[8](t)}function Z(t){e[9](t)}function ee(t){e[10](t)}void 0!==e[1]&&(K.recording=e[1]),void 0!==e[2]&&(K.feedback_list=e[2]),s=new Oe({props:K}),L.push((()=>B(s,"recording",Y))),L.push((()=>B(s,"feedback_list",Q)));let te={};return void 0!==e[3]&&(te.documents=e[3]),void 0!==e[2]&&(te.feedback_list=e[2]),void 0!==e[1]&&(te.recording=e[1]),b=new tn({props:te}),L.push((()=>B(b,"documents",X))),L.push((()=>B(b,"feedback_list",Z))),L.push((()=>B(b,"recording",ee))),{c(){t=g("main"),n=g("div"),i=g("div"),W(s.$$.fragment),p=m(),h=g("div"),W(b.$$.fragment),q=m(),F=g("div"),T=g("button"),S=g("img"),N=f("\n                Select Feedback"),j=m(),M=g("button"),E=f("View Feedback List\n                "),H=g("img"),_(i,"width","100%"),_(i,"height","100%"),$(i,"gone",0!=e[0]),_(h,"width","100%"),_(h,"height","100%"),$(h,"gone",1!=e[0]),w(n,"class","carousel-container svelte-qf1jde"),a(S.src,C="./logos/move-to-the-prev-page-symbol-svgrepo-com.svg")||w(S,"src","./logos/move-to-the-prev-page-symbol-svgrepo-com.svg"),w(S,"alt","Previous page"),w(S,"class","mini-icon"),w(T,"class","action-button row centered svelte-qf1jde"),T.disabled=O=0===e[0],$(T,"invisible",1!=e[0]),a(H.src,P="./logos/move-to-the-next-page-symbol-svgrepo-com.svg")||w(H,"src","./logos/move-to-the-next-page-symbol-svgrepo-com.svg"),w(H,"alt","Next page"),w(H,"class","mini-icon"),w(M,"class","action-button row centered svelte-qf1jde"),M.disabled=D=e[0]===on.length-1||e[2].length<=0,$(M,"invisible",0!=e[0]),w(F,"class","navigation centered spaced bordered row svelte-qf1jde")},m(o,c){d(o,t,c),l(t,n),l(n,i),z(s,i,null),l(n,p),l(n,h),z(b,h,null),l(t,q),l(t,F),l(F,T),l(T,S),l(T,N),l(F,j),l(F,M),l(M,E),l(M,H),R=!0,U||(I=[v(T,"click",e[5]),v(M,"click",e[4])],U=!0)},p(e,[t]){const n={};!c&&2&t&&(c=!0,n.recording=e[1],A((()=>c=!1))),!r&&4&t&&(r=!0,n.feedback_list=e[2],A((()=>r=!1))),s.$set(n),(!R||1&t)&&$(i,"gone",0!=e[0]);const o={};!k&&8&t&&(k=!0,o.documents=e[3],A((()=>k=!1))),!y&&4&t&&(y=!0,o.feedback_list=e[2],A((()=>y=!1))),!x&&2&t&&(x=!0,o.recording=e[1],A((()=>x=!1))),b.$set(o),(!R||1&t)&&$(h,"gone",1!=e[0]),(!R||1&t&&O!==(O=0===e[0]))&&(T.disabled=O),(!R||1&t)&&$(T,"invisible",1!=e[0]),(!R||5&t&&D!==(D=e[0]===on.length-1||e[2].length<=0))&&(M.disabled=D),(!R||1&t)&&$(M,"invisible",0!=e[0])},i(e){R||(J(s.$$.fragment,e),J(b.$$.fragment,e),R=!0)},o(e){V(s.$$.fragment,e),V(b.$$.fragment,e),R=!1},d(e){e&&u(t),G(s),G(b),U=!1,o(I)}}}let on=2;function sn(e,t,n){let o=0,i="",s={},c=[],r=[];return F((async()=>{let e=window.prompt("Please enter your username: ");if(null==e||""==e)throw alert("Please enter a valid username"),new Error("Please enter a valid username");let t=await fetch("/check_username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e})});if(!t.ok)throw alert("Failed to check username"),new Error("Failed to check username");let o=await t.json();o.username_exists?(alert("Welcome back, "+o.username),i=o.username,o.user_id):(alert("Welcome, "+o.username),i=o.username,o.user_id);let s=await fetch("/get_user_id",{method:"POST",headers:{"Content-Type":"application/json"},body:{username:i}});if(!s.ok)throw alert("Failed to get user id"),new Error("Failed to get user id");const c=(await s.json()).user_id;alert("User ID: "+c),n(3,r=await fetch("/get_documents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:c})}).then((e=>e.json())).then((e=>e.documents)))})),[o,s,c,r,function(){o<on-1&&n(0,o+=1)},function(){o>0&&n(0,o-=1)},function(e){s=e,n(1,s)},function(e){c=e,n(2,c)},function(e){r=e,n(3,r)},function(e){c=e,n(2,c)},function(e){s=e,n(1,s)}]}return new class extends K{constructor(e){super(),Q(this,e,sn,nn,s,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
